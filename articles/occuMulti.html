<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multispecies occupancy models with occuMulti • unmarked</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Multispecies occupancy models with occuMulti">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/unmarked.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cap-recap.html">Modeling variation in abundance using capture-recapture data</a>
    </li>
    <li>
      <a href="../articles/colext.html">Dynamic occupancy models in unmarked</a>
    </li>
    <li>
      <a href="../articles/contributing_to_unmarked.html">Contributing to unmarked: guide to adding a new model to `unmarked`</a>
    </li>
    <li>
      <a href="../articles/distsamp.html">Distance sampling analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/occuComm.html">Community occupancy models with occuComm</a>
    </li>
    <li>
      <a href="../articles/occuMulti.html">Multispecies occupancy models with occuMulti</a>
    </li>
    <li>
      <a href="../articles/powerAnalysis.html">Power Analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/simulate.html">Simulating datasets</a>
    </li>
    <li>
      <a href="../articles/spp-dist.html">Modeling and mapping species distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/biodiverse/unmarked/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multispecies occupancy models with
occuMulti</h1>
                        <h4 data-toc-skip class="author">Ken
Kellner</h4>
            
            <h4 data-toc-skip class="date">November 15, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/biodiverse/unmarked/blob/HEAD/vignettes/occuMulti.Rmd" class="external-link"><code>vignettes/occuMulti.Rmd</code></a></small>
      <div class="hidden name"><code>occuMulti.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <span class="citation">Rota et al. (2016)</span> occupancy model
is designed for presence/absence datasets with two or more (potentially)
interacting species. The model allows for estimation of occupancy
probabilities and the strength of interactions between species, as well
as covariate effects on these parameters. The model generalizes the
standard single-species occupancy model from <span class="citation">MacKenzie et al. (2002)</span>.</p>
<p>The model assumes the latent occupancy state at site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
for a set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
potentially interacting species is a vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Z_i</annotation></semantics></math>
of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
containing a sequence of the values 0 or 1. For example, when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">s = 2</annotation></semantics></math>,
the possible states are [11], [10], [01], or [00], corresponding to both
species present, only species 1 or species 2 present, or both species
absent, respectively. The latent state modeled as a multivariate
Bernoulli random variable:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub><mo>∼</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">V</mi><mi mathvariant="normal">B</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
  Z_i \sim \mathrm{MVB}(\psi_i)
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_i</annotation></semantics></math>
is a vector of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>2</mn><mi>s</mi></msup><annotation encoding="application/x-tex">2^s</annotation></semantics></math>
containing the probability of each possible combination of 0s and 1s,
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum \psi_i = 1</annotation></semantics></math>.</p>
<p>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">s = 2</annotation></semantics></math>,
the corresponding natural parameters,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>,
are</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>f</mi><mn>1</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ψ</mi><mn>10</mn></msub><mi>/</mi><msub><mi>ψ</mi><mn>00</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>f</mi><mn>2</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ψ</mi><mn>01</mn></msub><mi>/</mi><msub><mi>ψ</mi><mn>00</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>f</mi><mn>12</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ψ</mi><mn>11</mn></msub><mo>*</mo><msub><mi>ψ</mi><mn>00</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ψ</mi><mn>10</mn></msub><mo>*</mo><msub><mi>ψ</mi><mn>01</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{split}
  f_1 &amp;= \mathrm{log}(\psi_{10}/\psi_{00}) \\                      
  f_2 &amp;= \mathrm{log}(\psi_{01}/\psi_{00}) \\                      
  f_{12} &amp;= \mathrm{log}((\psi_{11} * \psi_{00})/(\psi_{10} * \psi_{01}))
\end{split}
</annotation></semantics></math></p>
<p>The natural parameters can then be modeled as linear functions of
covariates.</p>
<p>The observation process is similar to the standard single-species
occupancy model, except that the observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
at site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
on occasion
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
are vectors of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
and there are independent values of detection probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
for each species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Z</mi><mi>i</mi></msub><mo>∼</mo><mrow><mi mathvariant="normal">B</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mi>i</mi></msub><mo>*</mo><msub><mi>p</mi><mrow><mi>s</mi><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
  y_{ij} | Z_i \sim \mathrm{Bernoulli}(Z_i * p_{sij})
</annotation></semantics></math> See <span class="citation">Rota et al.
(2016)</span> for more details on model structure. In
<code>unmarked</code>, the model can be fit with the
<code>occuMulti</code> function.</p>
</div>
<div class="section level2">
<h2 id="simple-multispecies-analysis">Simple multispecies analysis<a class="anchor" aria-label="anchor" href="#simple-multispecies-analysis"></a>
</h2>
<p>We will start with a simple analysis using presence/absence data from
camera traps for three species: coyote, red fox, and bobcat. The data
are a simplified version of the data used in <span class="citation">Rota
et al. (2016)</span>, with the data collapsed three into three-week long
time periods.</p>
<div class="section level3">
<h3 id="formatting-the-data">Formatting the data<a class="anchor" aria-label="anchor" href="#formatting-the-data"></a>
</h3>
<p>The dataset is included with <code>unmarked</code> and is called
<code>MesoCarnivores</code>. First, we need to load in the dataset,
which is a list with several components.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://groups.google.com/d/forum/unmarked" class="external-link">unmarked</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MesoCarnivores</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">MesoCarnivores</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "bobcat"   "coyote"   "redfox"   "sitecovs"</span></span></code></pre>
<p>Presence/absence matrices for the three species are in list elements
<code>bobcat</code>, <code>coyote</code>, and <code>redfox</code>, and
<code>sitecovs</code> contains the site-level covariate data.</p>
<p>Using this information, we will create an
<code>unmarkedFrameOccuMulti</code> object. You can get more information
by looking at the help file for <code>unmarkedFrameOccuMulti</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">unmarkedFrameOccuMulti</span></span></code></pre></div>
<p>First we combine the detection data for the 3 species into one named
list. These names will be used throughout the multispecies analysis, so
pick useful ones.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ylist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bobcat<span class="op">=</span><span class="va">MesoCarnivores</span><span class="op">$</span><span class="va">bobcat</span>, coyote<span class="op">=</span><span class="va">MesoCarnivores</span><span class="op">$</span><span class="va">coyote</span>, </span>
<span>              redfox<span class="op">=</span><span class="va">MesoCarnivores</span><span class="op">$</span><span class="va">redfox</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ylist</span>, <span class="va">head</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $bobcat</span></span>
<span><span class="co">##      X1 X2 X3</span></span>
<span><span class="co">## [1,]  0  0  0</span></span>
<span><span class="co">## [2,]  0  0  0</span></span>
<span><span class="co">## [3,]  0  0  0</span></span>
<span><span class="co">## [4,]  0  0  0</span></span>
<span><span class="co">## [5,]  0  0  0</span></span>
<span><span class="co">## [6,]  0  0  0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $coyote</span></span>
<span><span class="co">##      X1 X2 X3</span></span>
<span><span class="co">## [1,]  0  0  0</span></span>
<span><span class="co">## [2,]  0  0  0</span></span>
<span><span class="co">## [3,]  0  0  0</span></span>
<span><span class="co">## [4,]  0  0  0</span></span>
<span><span class="co">## [5,]  0  0  0</span></span>
<span><span class="co">## [6,]  0  0  0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $redfox</span></span>
<span><span class="co">##      X1 X2 X3</span></span>
<span><span class="co">## [1,]  0  0  0</span></span>
<span><span class="co">## [2,]  0  0  0</span></span>
<span><span class="co">## [3,]  0  0  1</span></span>
<span><span class="co">## [4,]  0  0  0</span></span>
<span><span class="co">## [5,]  0  0  0</span></span>
<span><span class="co">## [6,]  1  1  1</span></span></code></pre>
<p>The site covariates are contained in a data frame:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">MesoCarnivores</span><span class="op">$</span><span class="va">sitecovs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Dist_5km HDens_5km  Latitude  Longitude People_site Trail</span></span>
<span><span class="co">## 1     0.04  9.345258 0.3899441 -0.7723958       0.857     1</span></span>
<span><span class="co">## 2     0.03  9.499197 0.3899250 -0.7723920       0.002     0</span></span>
<span><span class="co">## 3     0.03  9.647173 0.3899111 -0.7723954       0.387     1</span></span>
<span><span class="co">## 4     0.03  9.598066 0.3899166 -0.7723972       0.003     0</span></span>
<span><span class="co">## 5     0.03  9.607825 0.3899179 -0.7724004       0.000     0</span></span>
<span><span class="co">## 6     0.03  9.748791 0.3899058 -0.7724046       0.443     1</span></span></code></pre>
<p>The site covariates include a metric of disturbance in a 5 km radius
(<code>Dist_5km</code>), housing density in a 5 km radius
(<code>HDens_5km</code>), latitude, longitude, a metric of how many
people use the site (<code>People_site</code>) and whether the camera
site is on (or off) a trail. Using our <code>ylist</code>, site
covariates, and observation covariates, we can construct an
<code>unmarkedFrameOccuMulti</code> object.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">umf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unmarkedFrameOccuMulti.html">unmarkedFrameOccuMulti</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">ylist</span>, siteCovs<span class="op">=</span><span class="va">MesoCarnivores</span><span class="op">$</span><span class="va">sitecovs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="occupancy-formulas">Occupancy formulas<a class="anchor" aria-label="anchor" href="#occupancy-formulas"></a>
</h3>
<p>While most <code>unmarked</code> models have only one or two formulas
(and a single formula for occupancy or abundance),
<code>occuMulti</code> requires one formula per natural parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>.
Thus, there will be multiple formulas associated with occupancy. These
formulas are organized into an ordered character vector. It can be hard
to keep track of how many natural parameters there are and what each one
represents. It can be helpful to look at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>-design
matrix, which is generated by <code>unmarkedFrameOccuMulti</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">umf</span><span class="op">@</span><span class="va">fDesign</span></span></code></pre></div>
<pre><code><span><span class="co">##          f1[bobcat] f2[coyote] f3[redfox] f4[bobcat:coyote] f5[bobcat:redfox]</span></span>
<span><span class="co">## psi[111]          1          1          1                 1                 1</span></span>
<span><span class="co">## psi[110]          1          1          0                 1                 0</span></span>
<span><span class="co">## psi[101]          1          0          1                 0                 1</span></span>
<span><span class="co">## psi[100]          1          0          0                 0                 0</span></span>
<span><span class="co">## psi[011]          0          1          1                 0                 0</span></span>
<span><span class="co">## psi[010]          0          1          0                 0                 0</span></span>
<span><span class="co">## psi[001]          0          0          1                 0                 0</span></span>
<span><span class="co">## psi[000]          0          0          0                 0                 0</span></span>
<span><span class="co">##          f6[coyote:redfox] f7[bobcat:coyote:redfox]</span></span>
<span><span class="co">## psi[111]                 1                        1</span></span>
<span><span class="co">## psi[110]                 0                        0</span></span>
<span><span class="co">## psi[101]                 0                        0</span></span>
<span><span class="co">## psi[100]                 0                        0</span></span>
<span><span class="co">## psi[011]                 1                        0</span></span>
<span><span class="co">## psi[010]                 0                        0</span></span>
<span><span class="co">## psi[001]                 0                        0</span></span>
<span><span class="co">## psi[000]                 0                        0</span></span></code></pre>
<p>The number and order of the formulas in the vector should match the
column names of this matrix. There are 7 columns in the matrix: thus,
we’ll need 7 formulas total, and they should be provided in the
following order:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">umf</span><span class="op">@</span><span class="va">fDesign</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "f1[bobcat]"               "f2[coyote]"              </span></span>
<span><span class="co">## [3] "f3[redfox]"               "f4[bobcat:coyote]"       </span></span>
<span><span class="co">## [5] "f5[bobcat:redfox]"        "f6[coyote:redfox]"       </span></span>
<span><span class="co">## [7] "f7[bobcat:coyote:redfox]"</span></span></code></pre>
<p>For this model we’ll set the 1st and 2nd-order
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
parameters to be intercept-only, and fix the 3rd order parameter at 0.
We will combine our formulas into a vector called
<code>stateformulas</code>, like this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stateformulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"0"</span><span class="op">)</span></span></code></pre></div>
<p>Notice that the formulas are character strings (each wrapped in
<code>""</code>). This is required.</p>
</div>
<div class="section level3">
<h3 id="detection-formulas">Detection formulas<a class="anchor" aria-label="anchor" href="#detection-formulas"></a>
</h3>
<p>Each species has its own detection probability formula. Thus, there
should be 3 total formulas combined in a <code>detformulas</code>
vector. The order of the formulas should match the order of species in
<code>ylist</code>. For this model, all three species will have
intercept-only detection formulas.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">detformulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-the-model">Fit the model<a class="anchor" aria-label="anchor" href="#fit-the-model"></a>
</h3>
<p>First, look at the help file for <code>occuMulti</code> to check what
the required arguments are:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">occuMulti</span></span></code></pre></div>
<p>We now have all the pieces we need
(<code>unmarkedFrameOccuMulti</code>, <code>stateformulas</code>,
<code>detformulas</code>) needed to run a basic model which we will call
<code>mod_null</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occuMulti.html">occuMulti</a></span><span class="op">(</span>detformulas<span class="op">=</span><span class="va">detformulas</span>, stateformulas<span class="op">=</span><span class="va">stateformulas</span>, data<span class="op">=</span><span class="va">umf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_null</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## occuMulti(detformulas = detformulas, stateformulas = stateformulas, </span></span>
<span><span class="co">##     data = umf, maxOrder = 3L)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Occupancy (logit-scale):</span></span>
<span><span class="co">##                             Estimate    SE      z  P(&gt;|z|)</span></span>
<span><span class="co">## [bobcat] (Intercept)           -1.76 0.179  -9.81 1.03e-22</span></span>
<span><span class="co">## [coyote] (Intercept)           -1.30 0.137  -9.54 1.37e-21</span></span>
<span><span class="co">## [redfox] (Intercept)           -2.20 0.152 -14.44 2.81e-47</span></span>
<span><span class="co">## [bobcat:coyote] (Intercept)     1.72 0.262   6.56 5.48e-11</span></span>
<span><span class="co">## [bobcat:redfox] (Intercept)    -1.38 0.377  -3.66 2.57e-04</span></span>
<span><span class="co">## [coyote:redfox] (Intercept)     1.41 0.248   5.69 1.31e-08</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection (logit-scale):</span></span>
<span><span class="co">##                      Estimate     SE     z  P(&gt;|z|)</span></span>
<span><span class="co">## [bobcat] (Intercept)   -1.106 0.1398 -7.91 2.59e-15</span></span>
<span><span class="co">## [coyote] (Intercept)   -0.331 0.0761 -4.35 1.38e-05</span></span>
<span><span class="co">## [redfox] (Intercept)   -0.253 0.1183 -2.13 3.28e-02</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## AIC: 6626.111 </span></span>
<span><span class="co">## Number of sites: 1437</span></span></code></pre>
<p>The regression parameters associated with each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
are identified by the species name (or combination of species names) in
brackets.</p>
<p>A few things to notice:</p>
<ul>
<li>Coyote occupancy is the highest of the three species.</li>
<li>Negative relationship between bobcat and red fox</li>
<li>Positive relationships between coyote and the other two species</li>
<li>There is no three-species interaction term in the summary, because
we fixed it at 0.</li>
</ul>
</div>
<div class="section level3">
<h3 id="occupancy-probabilities">Occupancy probabilities<a class="anchor" aria-label="anchor" href="#occupancy-probabilities"></a>
</h3>
<p>To get the expected probability for each occupancy state ([11], [10]
and so on) at each site, use the <code>predict</code> function. This
gives you the probabilities along with standard errors and a 95% CI.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occ_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_null</span>, type<span class="op">=</span><span class="st">"state"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">occ_prob</span><span class="op">$</span><span class="va">Predicted</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        psi[111]  psi[110]    psi[101]   psi[100]   psi[011] psi[010]   psi[001]</span></span>
<span><span class="co">## [1,] 0.01515889 0.1320403 0.002441193 0.08730259 0.06259129 0.137555 0.05616217</span></span>
<span><span class="co">## [2,] 0.01515889 0.1320403 0.002441193 0.08730259 0.06259129 0.137555 0.05616217</span></span>
<span><span class="co">## [3,] 0.01515889 0.1320403 0.002441193 0.08730259 0.06259129 0.137555 0.05616217</span></span>
<span><span class="co">## [4,] 0.01515889 0.1320403 0.002441193 0.08730259 0.06259129 0.137555 0.05616217</span></span>
<span><span class="co">## [5,] 0.01515889 0.1320403 0.002441193 0.08730259 0.06259129 0.137555 0.05616217</span></span>
<span><span class="co">## [6,] 0.01515889 0.1320403 0.002441193 0.08730259 0.06259129 0.137555 0.05616217</span></span>
<span><span class="co">##       psi[000]</span></span>
<span><span class="co">## [1,] 0.5067485</span></span>
<span><span class="co">## [2,] 0.5067485</span></span>
<span><span class="co">## [3,] 0.5067485</span></span>
<span><span class="co">## [4,] 0.5067485</span></span>
<span><span class="co">## [5,] 0.5067485</span></span>
<span><span class="co">## [6,] 0.5067485</span></span></code></pre>
<p>The rows of this matrix should sum to 1. All rows are the same
because estimated occupancies at all sites are the same - we didn’t
include any covariates.</p>
</div>
<div class="section level3">
<h3 id="marginal-occupancy">Marginal occupancy<a class="anchor" aria-label="anchor" href="#marginal-occupancy"></a>
</h3>
<p>It’s often more interesting to look at occupancy for species
individually. For example, you might want to know the marginal occupancy
of one species at each site (across all possible occupancy states).</p>
<p>You can do this by specifying the <code>species</code> argument in
<code>predict</code>, which will automatically sum up the appropriate
occupancy states.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redfox_marginal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_null</span>, type<span class="op">=</span><span class="st">"state"</span>, species<span class="op">=</span><span class="st">"redfox"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">redfox_marginal</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Predicted         SE     lower     upper</span></span>
<span><span class="co">## 1 0.1363536 0.00995898 0.1163041 0.1520995</span></span>
<span><span class="co">## 2 0.1363536 0.00995898 0.1163041 0.1520995</span></span>
<span><span class="co">## 3 0.1363536 0.00995898 0.1163041 0.1520995</span></span>
<span><span class="co">## 4 0.1363536 0.00995898 0.1163041 0.1520995</span></span>
<span><span class="co">## 5 0.1363536 0.00995898 0.1163041 0.1520995</span></span>
<span><span class="co">## 6 0.1363536 0.00995898 0.1163041 0.1520995</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="plotting-marginal-occupancy">Plotting marginal occupancy<a class="anchor" aria-label="anchor" href="#plotting-marginal-occupancy"></a>
</h3>
<p>Outputs from <code>predict</code> can be used to compare marginal
occupancy across species with a plot. First, we’ll need to get marginal
occupancy for the other two species, and combine the three estimates
into a single data frame.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coy_marginal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_null</span>, type<span class="op">=</span><span class="st">"state"</span>, species<span class="op">=</span><span class="st">"coyote"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bob_marginal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_null</span>, type<span class="op">=</span><span class="st">"state"</span>, species<span class="op">=</span><span class="st">"bobcat"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_marginal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">redfox_marginal</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="va">coy_marginal</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="va">bob_marginal</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">all_marginal</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Red fox"</span>, <span class="st">"Coyote"</span>, <span class="st">"Bobcat"</span><span class="op">)</span></span></code></pre></div>
<p>Now we can plot the estimated marginal occupancy for each species,
along with 95% CIs.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">all_marginal</span><span class="op">$</span><span class="va">Predicted</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.4</span><span class="op">)</span>, </span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">3.5</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, cex<span class="op">=</span><span class="fl">1.5</span>, xaxt<span class="op">=</span><span class="st">'n'</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">"Marginal occupancy and 95% CI"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, labels<span class="op">=</span><span class="va">all_marginal</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CIs</span></span>
<span><span class="va">top</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">all_marginal</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">i</span>, <span class="va">all_marginal</span><span class="op">$</span><span class="va">upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="va">top</span>, <span class="va">all_marginal</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">i</span><span class="op">+</span><span class="va">top</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="va">top</span>, <span class="va">all_marginal</span><span class="op">$</span><span class="va">upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">i</span><span class="op">+</span><span class="va">top</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="occuMulti_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="conditional-occupancy">Conditional occupancy<a class="anchor" aria-label="anchor" href="#conditional-occupancy"></a>
</h3>
<p>Alternatively, you might want to know the probability of occupancy of
one species, conditional on the presence of another. Use the
<code>species</code> and <code>cond</code> arguments together for this.
For example, the probability of red fox occupancy, conditional on coyote
presence:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redfox_coy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_null</span>, type<span class="op">=</span><span class="st">"state"</span>, species<span class="op">=</span><span class="st">"redfox"</span>, cond<span class="op">=</span><span class="st">"coyote"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">redfox_coy</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Predicted         SE    lower     upper</span></span>
<span><span class="co">## 1  0.223841 0.02439509 0.185338 0.2746938</span></span>
<span><span class="co">## 2  0.223841 0.02439509 0.185338 0.2746938</span></span>
<span><span class="co">## 3  0.223841 0.02439509 0.185338 0.2746938</span></span>
<span><span class="co">## 4  0.223841 0.02439509 0.185338 0.2746938</span></span>
<span><span class="co">## 5  0.223841 0.02439509 0.185338 0.2746938</span></span>
<span><span class="co">## 6  0.223841 0.02439509 0.185338 0.2746938</span></span></code></pre>
<p>What about conditional on coyote <em>absence</em>? Simply add a
<code>"-"</code> before the species name.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redfox_nocoy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_null</span>, type<span class="op">=</span><span class="st">"state"</span>, species<span class="op">=</span><span class="st">"redfox"</span>, cond<span class="op">=</span><span class="st">"-coyote"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">redfox_nocoy</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Predicted         SE      lower     upper</span></span>
<span><span class="co">## 1 0.08979233 0.01195398 0.06952687 0.1165483</span></span>
<span><span class="co">## 2 0.08979233 0.01195398 0.06952687 0.1165483</span></span>
<span><span class="co">## 3 0.08979233 0.01195398 0.06952687 0.1165483</span></span>
<span><span class="co">## 4 0.08979233 0.01195398 0.06952687 0.1165483</span></span>
<span><span class="co">## 5 0.08979233 0.01195398 0.06952687 0.1165483</span></span>
<span><span class="co">## 6 0.08979233 0.01195398 0.06952687 0.1165483</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="plotting-conditional-occupancy">Plotting conditional occupancy<a class="anchor" aria-label="anchor" href="#plotting-conditional-occupancy"></a>
</h3>
<p>You can use this output from <code>predict</code> to generate
comparison plots.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">redfox_coy</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="va">redfox_nocoy</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">cond_data</span><span class="op">$</span><span class="va">Coyote_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Present"</span>,<span class="st">"Absent"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">cond_data</span><span class="op">$</span><span class="va">Predicted</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span><span class="op">)</span>, </span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">2.5</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, cex<span class="op">=</span><span class="fl">1.5</span>, xaxt<span class="op">=</span><span class="st">'n'</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">"Coyote status"</span>, ylab<span class="op">=</span><span class="st">"Red fox occupancy and 95% CI"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, labels<span class="op">=</span><span class="va">cond_data</span><span class="op">$</span><span class="va">Coyote_status</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CIs</span></span>
<span><span class="va">top</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">cond_data</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">i</span>, <span class="va">cond_data</span><span class="op">$</span><span class="va">upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="va">top</span>, <span class="va">cond_data</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">i</span><span class="op">+</span><span class="va">top</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="va">top</span>, <span class="va">cond_data</span><span class="op">$</span><span class="va">upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">i</span><span class="op">+</span><span class="va">top</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="occuMulti_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<p>Note that red fox occupancy is higher at sites where coyotes were
present, which corresponds with the positive interaction term between
the two species we saw in the model output summary.</p>
</div>
</div>
<div class="section level2">
<h2 id="multispecies-model-with-covariates">Multispecies model with covariates<a class="anchor" aria-label="anchor" href="#multispecies-model-with-covariates"></a>
</h2>
<p>Now we’ll fit a model with covariates on some natural parameters. It
might be helpful to look at the order for our
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
parameters again:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">umf</span><span class="op">@</span><span class="va">fDesign</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "f1[bobcat]"               "f2[coyote]"              </span></span>
<span><span class="co">## [3] "f3[redfox]"               "f4[bobcat:coyote]"       </span></span>
<span><span class="co">## [5] "f5[bobcat:redfox]"        "f6[coyote:redfox]"       </span></span>
<span><span class="co">## [7] "f7[bobcat:coyote:redfox]"</span></span></code></pre>
<p>And our available site covariates:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/unmarkedFrame-class.html">siteCovs</a></span><span class="op">(</span><span class="va">umf</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Dist_5km HDens_5km  Latitude  Longitude People_site Trail</span></span>
<span><span class="co">## 1     0.04  9.345258 0.3899441 -0.7723958       0.857     1</span></span>
<span><span class="co">## 2     0.03  9.499197 0.3899250 -0.7723920       0.002     0</span></span>
<span><span class="co">## 3     0.03  9.647173 0.3899111 -0.7723954       0.387     1</span></span>
<span><span class="co">## 4     0.03  9.598066 0.3899166 -0.7723972       0.003     0</span></span>
<span><span class="co">## 5     0.03  9.607825 0.3899179 -0.7724004       0.000     0</span></span>
<span><span class="co">## 6     0.03  9.748791 0.3899058 -0.7724046       0.443     1</span></span></code></pre>
<div class="section level3">
<h3 id="add-housing-density-as-a-covariate">Add housing density as a covariate<a class="anchor" aria-label="anchor" href="#add-housing-density-as-a-covariate"></a>
</h3>
<p>We’ll fit a model with an effect of housing density
(<code>HDens_5km</code>) on the first-order parameters for all three
species. The two-way interactions will remain intercept-only, and the
three-way interaction will remain fixed at 0. Here’s the vector of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
formulas:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~HDens_5km"</span>,<span class="st">"~HDens_5km"</span>,<span class="st">"~HDens_5km"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"0"</span><span class="op">)</span></span></code></pre></div>
<p>Inside your formula, you can wrap the variable name in to standardize
it, which we should do, because the housing density variable is not
scaled.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~scale(HDens_5km)"</span>,<span class="st">"~scale(HDens_5km)"</span>,<span class="st">"~scale(HDens_5km)"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"~1"</span>,<span class="st">"0"</span><span class="op">)</span></span></code></pre></div>
<p>Detection formulas will remain the same, so we’re now ready to fit a
new model, <code>mod_hdens</code>.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_hdens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occuMulti.html">occuMulti</a></span><span class="op">(</span>stateformulas<span class="op">=</span><span class="va">sf</span>, detformulas<span class="op">=</span><span class="va">detformulas</span>, <span class="va">umf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_hdens</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## occuMulti(detformulas = detformulas, stateformulas = sf, data = umf, </span></span>
<span><span class="co">##     maxOrder = 3L)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Occupancy (logit-scale):</span></span>
<span><span class="co">##                             Estimate     SE      z  P(&gt;|z|)</span></span>
<span><span class="co">## [bobcat] (Intercept)         -2.5364 0.2842  -8.92 4.53e-19</span></span>
<span><span class="co">## [bobcat] scale(HDens_5km)    -3.6008 0.9191  -3.92 8.94e-05</span></span>
<span><span class="co">## [coyote] (Intercept)         -1.3439 0.1470  -9.14 6.04e-20</span></span>
<span><span class="co">## [coyote] scale(HDens_5km)     0.0884 0.0742   1.19 2.34e-01</span></span>
<span><span class="co">## [redfox] (Intercept)         -2.2555 0.1566 -14.41 4.65e-47</span></span>
<span><span class="co">## [redfox] scale(HDens_5km)     0.4392 0.0831   5.29 1.24e-07</span></span>
<span><span class="co">## [bobcat:coyote] (Intercept)   1.8173 0.2714   6.70 2.16e-11</span></span>
<span><span class="co">## [bobcat:redfox] (Intercept)  -1.3385 0.3869  -3.46 5.42e-04</span></span>
<span><span class="co">## [coyote:redfox] (Intercept)   1.3740 0.2597   5.29 1.22e-07</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection (logit-scale):</span></span>
<span><span class="co">##                      Estimate     SE     z  P(&gt;|z|)</span></span>
<span><span class="co">## [bobcat] (Intercept)   -1.139 0.1421 -8.02 1.07e-15</span></span>
<span><span class="co">## [coyote] (Intercept)   -0.328 0.0759 -4.32 1.53e-05</span></span>
<span><span class="co">## [redfox] (Intercept)   -0.252 0.1179 -2.14 3.26e-02</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## AIC: 6530.476 </span></span>
<span><span class="co">## Number of sites: 1437</span></span></code></pre>
<p>A few things to note from the results:</p>
<ul>
<li>Housing density has a significant negative effect on occupancy of
bobcat</li>
<li>Housing density has a significant positive effect on red fox</li>
<li>No effect of housing density on coyote.</li>
</ul>
</div>
<div class="section level3">
<h3 id="plotting-covariate-effects">Plotting covariate effects<a class="anchor" aria-label="anchor" href="#plotting-covariate-effects"></a>
</h3>
<p>To plot the effect of housing density on marginal occupancy, we again
use <code>predict</code>. First, we need to generate sequence of
possible <code>Hdens_5km</code> values for the X-axis of our plot. We’ll
generate a sequence of 100 values, starting at the minimum observed
housing density and ending at the maximum observed value.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hdens_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="../reference/unmarkedFrame-class.html">siteCovs</a></span><span class="op">(</span><span class="va">umf</span><span class="op">)</span><span class="op">$</span><span class="va">HDens_5km</span><span class="op">)</span></span>
<span><span class="va">hdens_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">hdens_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">hdens_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Next, we’ll <code>predict</code> marginal coyote occupancy at each
value of <code>Hdens_5km</code> along our sequence. Our custom housing
density values should be in a data frame and provided to the
<code>newdata</code> argument. Because we used <code><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale()</a></code> in
our formulas above, there is no need to manually scale these new housing
density values - <code>unmarked</code> will do it for us.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>HDens_5km <span class="op">=</span> <span class="va">hdens_seq</span><span class="op">)</span></span>
<span><span class="va">occ_hdens_coy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_hdens</span>, type<span class="op">=</span><span class="st">"state"</span>, species<span class="op">=</span><span class="st">"coyote"</span>, newdata<span class="op">=</span><span class="va">nd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occ_hdens_coy</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="st">"Coyote"</span></span>
<span><span class="va">occ_hdens_coy</span><span class="op">$</span><span class="va">Hdens</span> <span class="op">&lt;-</span> <span class="va">hdens_seq</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">occ_hdens_coy</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Predicted         SE     lower     upper Species    Hdens</span></span>
<span><span class="co">## 1 0.3580999 0.01962920 0.3292159 0.4066751  Coyote 0.000000</span></span>
<span><span class="co">## 2 0.3416445 0.01724868 0.3166020 0.3790671  Coyote 1.885550</span></span>
<span><span class="co">## 3 0.3272412 0.01673791 0.3022966 0.3615434  Coyote 3.771100</span></span>
<span><span class="co">## 4 0.3149654 0.01736306 0.2849670 0.3543702  Coyote 5.656650</span></span>
<span><span class="co">## 5 0.3047727 0.01836143 0.2726425 0.3475827  Coyote 7.542199</span></span>
<span><span class="co">## 6 0.2965317 0.01931493 0.2628611 0.3404615  Coyote 9.427749</span></span></code></pre>
<p>We’ll do the same thing for the other two species.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occ_hdens_bob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_hdens</span>, type<span class="op">=</span><span class="st">"state"</span>, species<span class="op">=</span><span class="st">"bobcat"</span>, newdata<span class="op">=</span><span class="va">nd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occ_hdens_fox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_hdens</span>, type<span class="op">=</span><span class="st">"state"</span>, species<span class="op">=</span><span class="st">"redfox"</span>, newdata<span class="op">=</span><span class="va">nd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Bootstrapping confidence intervals with 100 samples</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occ_hdens_bob</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="st">"Bobcat"</span></span>
<span><span class="va">occ_hdens_fox</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="st">"Red fox"</span></span>
<span><span class="va">occ_hdens_bob</span><span class="op">$</span><span class="va">Hdens</span> <span class="op">&lt;-</span> <span class="va">hdens_seq</span></span>
<span><span class="va">occ_hdens_fox</span><span class="op">$</span><span class="va">Hdens</span> <span class="op">&lt;-</span> <span class="va">hdens_seq</span></span></code></pre></div>
<p>Finally, we’ll build our plot. Housing density will be on the x-axis,
marginal occupancy on the y-axis, and species will be identified by
colors.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">occ_hdens_coy</span><span class="op">$</span><span class="va">Hdens</span>, <span class="va">occ_hdens_coy</span><span class="op">$</span><span class="va">Predicted</span>, type<span class="op">=</span><span class="st">'l'</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>,</span>
<span>     col<span class="op">=</span><span class="st">'red'</span>, lwd<span class="op">=</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">"Housing density"</span>, ylab<span class="op">=</span><span class="st">"Marginal occupancy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">occ_hdens_bob</span><span class="op">$</span><span class="va">Hdens</span>, <span class="va">occ_hdens_bob</span><span class="op">$</span><span class="va">Predicted</span>, col<span class="op">=</span><span class="st">'blue'</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">occ_hdens_fox</span><span class="op">$</span><span class="va">Hdens</span>, <span class="va">occ_hdens_fox</span><span class="op">$</span><span class="va">Predicted</span>, col<span class="op">=</span><span class="st">'green'</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topleft'</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'red'</span>, <span class="st">'blue'</span>, <span class="st">'green'</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>,</span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Coyote"</span>, <span class="st">"Bobcat"</span>, <span class="st">"Red fox"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="occuMulti_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="model-selection">Model selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h2>
<p><code>unmarked</code> can calculate AIC,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>AIC,
and weights for a list of models automatically. Start by creating a
<code>fitList</code> object containing our two models:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitList.html">fitList</a></span><span class="op">(</span><span class="va">mod_null</span>, <span class="va">mod_hdens</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Your list was unnamed, so model names were added automatically</span></span></code></pre>
<p>Then call the function <code>modSel</code> on our list of models to
generate a model selection table:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/modSel.html">modSel</a></span><span class="op">(</span><span class="va">mods</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           nPars     AIC delta   AICwt cumltvWt</span></span>
<span><span class="co">## mod_hdens    12 6530.48  0.00 1.0e+00     1.00</span></span>
<span><span class="co">## mod_null      9 6626.11 95.64 1.7e-21     1.00</span></span></code></pre>
<p>Looks like the model with housing density is better.</p>
</div>
<div class="section level2">
<h2 id="model-fitting-challenges">Model fitting challenges<a class="anchor" aria-label="anchor" href="#model-fitting-challenges"></a>
</h2>
<p>Multispecies occupancy models often have many parameters, and can be
difficult to fit in some situations. You might get poor estimates (i.e.,
very large absolute values and/or large SEs) under certain
conditions:</p>
<ul>
<li>Sparse data (many 0s)</li>
<li>Boundary estimates (occupancy close to 0 or 1)</li>
<li>Few observations where multiple species are detected</li>
<li>Separation (perfect correlation with covariate)</li>
</ul>
<p>Here’s an example of a complex model with many covariates that
results in poor estimates.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">state_complex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"~scale(Dist_5km)+scale(HDens_5km)"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">det_complex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"~Trail"</span>,<span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_complex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occuMulti.html">occuMulti</a></span><span class="op">(</span>stateformulas<span class="op">=</span><span class="va">state_complex</span>, detformulas<span class="op">=</span><span class="va">det_complex</span>, <span class="va">umf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_complex</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## occuMulti(detformulas = det_complex, stateformulas = state_complex,</span></span>
<span><span class="co">##     data = umf, maxOrder = 3L)</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Occupancy (logit-scale):</span></span>
<span><span class="co">##                                  Estimate     SE      z  P(&gt;|z|)</span></span>
<span><span class="co">## [bobcat] (Intercept)             -23.0171  5.784 -3.980 6.90e-05</span></span>
<span><span class="co">## [bobcat] scale(Dist_5km)          -2.4249  0.689 -3.519 4.34e-04</span></span>
<span><span class="co">## [bobcat] scale(HDens_5km)        -82.3836 19.788 -4.163 3.14e-05</span></span>
<span><span class="co">## [coyote] (Intercept)              -0.6789  0.225 -3.017 2.55e-03</span></span>
<span><span class="co">## [coyote] scale(Dist_5km)          -0.0176  0.139 -0.127 8.99e-01</span></span>
<span><span class="co">## [coyote] scale(HDens_5km)         -0.5534  0.748 -0.740 4.59e-01</span></span>
<span><span class="co">## [redfox] (Intercept)              -1.3946  0.257 -5.425 5.78e-08</span></span>
<span><span class="co">## [redfox] scale(Dist_5km)          -0.5293  0.250 -2.115 3.45e-02</span></span>
<span><span class="co">## [redfox] scale(HDens_5km)          0.2108  0.261  0.808 4.19e-01</span></span>
<span><span class="co">## [bobcat:coyote] (Intercept)        6.7598  6.384  1.059 2.90e-01</span></span>
<span><span class="co">## [bobcat:coyote] scale(Dist_5km)    1.6979  0.695  2.445 1.45e-02</span></span>
<span><span class="co">## [bobcat:coyote] scale(HDens_5km)  17.9202 21.442  0.836 4.03e-01</span></span>
<span><span class="co">## [bobcat:redfox] (Intercept)       15.3983  3.462  4.448 8.67e-06</span></span>
<span><span class="co">## [bobcat:redfox] scale(Dist_5km)    0.8836  0.439  2.014 4.40e-02</span></span>
<span><span class="co">## [bobcat:redfox] scale(HDens_5km)  64.1330 12.377  5.182 2.20e-07</span></span>
<span><span class="co">## [coyote:redfox] (Intercept)        1.1084  0.363  3.050 2.29e-03</span></span>
<span><span class="co">## [coyote:redfox] scale(Dist_5km)    0.1149  0.340  0.338 7.35e-01</span></span>
<span><span class="co">## [coyote:redfox] scale(HDens_5km)   0.9046  0.781  1.159 2.47e-01</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection (logit-scale):</span></span>
<span><span class="co">##                      Estimate     SE      z  P(&gt;|z|)</span></span>
<span><span class="co">## [bobcat] (Intercept)    -2.83 0.1419 -19.91 3.10e-88</span></span>
<span><span class="co">## [bobcat] Trail           1.74 0.1542  11.26 2.10e-29</span></span>
<span><span class="co">## [coyote] (Intercept)    -1.96 0.0984 -19.88 5.89e-88</span></span>
<span><span class="co">## [coyote] Trail           2.17 0.1220  17.75 1.63e-70</span></span>
<span><span class="co">## [redfox] (Intercept)    -1.59 0.1601  -9.93 2.97e-23</span></span>
<span><span class="co">## [redfox] Trail           1.78 0.1997   8.93 4.12e-19</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## AIC: 5958.196</span></span>
<span><span class="co">## Number of sites: 1437</span></span>
<span><span class="co">## optim convergence code: 0</span></span>
<span><span class="co">## optim iterations: 196</span></span>
<span><span class="co">## Bootstrap iterations: 0</span></span></code></pre>
<p>Note that several estimates are very large (&gt;10) and also have
large SEs. You should be very skeptical about using a model with poor
estimates, like this one, for inference. Potential solutions when you
get poor estimates include:</p>
<ul>
<li>Fit simpler models with fewer covariates</li>
<li>If possible, fit the model with fewer species</li>
<li>Adjust observation period length if possible (e.g. collapse from
one-week periods to three-week periods)</li>
<li>Use penalized likelihood to fit the model</li>
</ul>
</div>
<div class="section level2">
<h2 id="penalized-likelihood">Penalized likelihood<a class="anchor" aria-label="anchor" href="#penalized-likelihood"></a>
</h2>
<p><code>occuMulti</code> uses maximum likelihood to estimate
parameters. We can add a “penalty” to the calculated likelihood to keep
parameter estimates from getting stuck at huge values Use of penalized
likelihood has been shown to help with separation/boundary issues,
eliminate unreasonably large estimates, and reduce error, However, note
that the penalty term introduces a small amount of bias in the parameter
estimates: thus, we are making a tradeoff between bias and variance With
huge SEs as with the previous model, this may be a good tradeoff to
make.</p>
<p>One type of penalty is the “Bayes” penalty:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>λ</mi><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mi>i</mi></munder><mrow></mrow><msubsup><mi>θ</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">
-\lambda\frac{1}{2}\sum_i{}\theta_i^2
</annotation></semantics></math> In the formula above,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
is the penalty value, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is the vector of estimated parameters. As the parameter values get
bigger, the total penalty increases.</p>
<div class="section level3">
<h3 id="penalized-likelihood-with-occumulti">Penalized likelihood with occuMulti<a class="anchor" aria-label="anchor" href="#penalized-likelihood-with-occumulti"></a>
</h3>
<p><code>occuMulti</code> can use penalized likelihood to fit models.
You can provide a value to the <code>penalty</code> argument directly,
or use the <code>optimizePenalty</code> function on a fitted model to
choose the best value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
using K-fold cross-validation, and re-fit the model using the optimal
penalty term value.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">mod_penalty</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimizePenalty-methods.html">optimizePenalty</a></span><span class="op">(</span><span class="va">mod_complex</span>, penalties<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_penalty</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Optimal penalty is 1</span></span>
<span><span class="co">## Bootstraping covariance matrix</span></span>
<span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## occuMulti(detformulas = c("~Trail", "~Trail", "~Trail"), stateformulas = c("~scale(Dist_5km)+scale(HDens_5km)",</span></span>
<span><span class="co">## "~scale(Dist_5km)+scale(HDens_5km)", "~scale(Dist_5km)+scale(HDens_5km)",</span></span>
<span><span class="co">## "~scale(Dist_5km)+scale(HDens_5km)", "~scale(Dist_5km)+scale(HDens_5km)",</span></span>
<span><span class="co">## "~scale(Dist_5km)+scale(HDens_5km)", "0"), data = object@data,</span></span>
<span><span class="co">##     maxOrder = 3L, penalty = 1, boot = boot)</span></span>
<span></span>
<span><span class="co">## Occupancy (logit-scale):</span></span>
<span><span class="co">##                                  Estimate    SE      z  P(&gt;|z|)</span></span>
<span><span class="co">## [bobcat] (Intercept)              -1.7810 0.221 -8.054 8.00e-16</span></span>
<span><span class="co">## [bobcat] scale(Dist_5km)          -1.3143 0.337 -3.903 9.48e-05</span></span>
<span><span class="co">## [bobcat] scale(HDens_5km)         -2.8200 0.529 -5.334 9.61e-08</span></span>
<span><span class="co">## [coyote] (Intercept)              -0.6049 0.178 -3.407 6.56e-04</span></span>
<span><span class="co">## [coyote] scale(Dist_5km)           0.0285 0.150  0.190 8.49e-01</span></span>
<span><span class="co">## [coyote] scale(HDens_5km)         -1.0908 0.397 -2.748 5.99e-03</span></span>
<span><span class="co">## [redfox] (Intercept)              -1.5659 0.310 -5.059 4.22e-07</span></span>
<span><span class="co">## [redfox] scale(Dist_5km)          -0.3068 0.138 -2.226 2.60e-02</span></span>
<span><span class="co">## [redfox] scale(HDens_5km)          0.4730 0.797  0.593 5.53e-01</span></span>
<span><span class="co">## [bobcat:coyote] (Intercept)        1.1871 0.372  3.195 1.40e-03</span></span>
<span><span class="co">## [bobcat:coyote] scale(Dist_5km)    0.9347 0.368  2.537 1.12e-02</span></span>
<span><span class="co">## [bobcat:coyote] scale(HDens_5km)  -0.3218 1.043 -0.309 7.58e-01</span></span>
<span><span class="co">## [bobcat:redfox] (Intercept)       -0.8831 0.346 -2.553 1.07e-02</span></span>
<span><span class="co">## [bobcat:redfox] scale(Dist_5km)    0.0364 0.233  0.156 8.76e-01</span></span>
<span><span class="co">## [bobcat:redfox] scale(HDens_5km)   2.5609 1.074  2.384 1.71e-02</span></span>
<span><span class="co">## [coyote:redfox] (Intercept)        1.0001 0.249  4.009 6.09e-05</span></span>
<span><span class="co">## [coyote:redfox] scale(Dist_5km)    0.0236 0.229  0.103 9.18e-01</span></span>
<span><span class="co">## [coyote:redfox] scale(HDens_5km)   1.3920 0.424  3.281 1.03e-03</span></span>
<span></span>
<span><span class="co">## Detection (logit-scale):</span></span>
<span><span class="co">##                      Estimate    SE      z  P(&gt;|z|)</span></span>
<span><span class="co">## [bobcat] (Intercept)    -2.44 0.150 -16.22 3.72e-59</span></span>
<span><span class="co">## [bobcat] Trail           1.74 0.164  10.61 2.59e-26</span></span>
<span><span class="co">## [coyote] (Intercept)    -1.89 0.117 -16.24 2.72e-59</span></span>
<span><span class="co">## [coyote] Trail           2.10 0.150  14.00 1.52e-44</span></span>
<span><span class="co">## [redfox] (Intercept)    -1.49 0.206  -7.21 5.66e-13</span></span>
<span><span class="co">## [redfox] Trail           1.72 0.254   6.79 1.14e-11</span></span>
<span></span>
<span><span class="co">## AIC: 6135.555</span></span>
<span><span class="co">## Number of sites: 1437</span></span>
<span><span class="co">## optim convergence code: 0</span></span>
<span><span class="co">## optim iterations: 100</span></span>
<span><span class="co">## Bootstrap iterations: 30</span></span></code></pre>
<p>Notice that parameter estimates and SEs for the model using penalized
likelihood are no longer gigantic. For more info on the use of penalized
likelihood with multispecies occupancy models, see <span class="citation">Clipp et al. (2021)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Clipp_2021" class="csl-entry">
Clipp, H. L., A. L. Evans, B. E. Kessinger, K. Kellner, and C. T. Rota.
2021. A penalized likelihood for multispecies occupancy models improves
predictions of species interactions. Ecology:e03520.
</div>
<div id="ref-mackenzie_estimating_2002" class="csl-entry">
MacKenzie, D. I., J. D. Nichols, G. B. Lachman, S. Droege, J. A. Royle,
and C. A. Langtimm. 2002. Estimating site occupancy rates when detection
probabilities are less than one. Ecology 83:2248–2255.
</div>
<div id="ref-Rota2016" class="csl-entry">
Rota, C. T., M. A. R. Ferreira, R. Kays, T. D. Forrester, E. L. Kalies,
W. J. McShea, A. W. Parsons, and J. J. Millspaugh. 2016. <a href="https://doi.org/10.1111/2041-210X.12587" class="external-link">A multi-species occupancy
model for two or more interacting species</a>. Methods in Ecology and
Evolution 7:1164–1173.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://chandlerlab.uga.edu/richard-chandler-phd/" class="external-link">Richard Chandler</a>, <a href="https://kenkellner.com" class="external-link">Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith, Lea Pautrel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
