<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of unmarked: an R Package for the Analysis of Data from Unmarked Animals â€¢ unmarked</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview of unmarked: an R Package for the Analysis of Data from Unmarked Animals">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/unmarked.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cap-recap.html">Modeling variation in abundance using capture-recapture data</a>
    </li>
    <li>
      <a href="../articles/colext.html">Dynamic occupancy models in unmarked</a>
    </li>
    <li>
      <a href="../articles/contributing_to_unmarked.html">Contributing to unmarked: guide to adding a new model to `unmarked`</a>
    </li>
    <li>
      <a href="../articles/distsamp.html">Distance sampling analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/occuMulti.html">Multispecies occupancy models with occuMulti</a>
    </li>
    <li>
      <a href="../articles/powerAnalysis.html">Power Analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/simulate.html">Simulating datasets</a>
    </li>
    <li>
      <a href="../articles/spp-dist.html">Modeling and mapping species distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hmecology/unmarked/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="unmarked_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Overview of unmarked: an R Package for the Analysis of Data from Unmarked Animals</h1>
                        <h4 data-toc-skip class="author">Ian Fiske</h4>
                                    <h4 data-toc-skip class="author">Richard Chandler</h4>
                        
            <h4 data-toc-skip class="date">February 5, 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hmecology/unmarked/blob/HEAD/vignettes/unmarked.Rmd" class="external-link"><code>vignettes/unmarked.Rmd</code></a></small>
      <div class="hidden name"><code>unmarked.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p><code>unmarked</code> aims to be a complete environment for the statistical analysis of data from surveys of unmarked animals. Currently, the focus is on hierarchical models that separately model a latent state (or states) and an observation process. This vignette provides a brief overview of the package - for a more thorough treatment see <span class="citation">Fiske and Chandler (2011)</span>.</p>
</div>
<div class="section level2">
<h2 id="overview-of-unmarked">Overview of unmarked<a class="anchor" aria-label="anchor" href="#overview-of-unmarked"></a>
</h2>
<p>Unmarked provides methods to estimate site occupancy, abundance, and density of animals (or possibly other organisms/objects) that cannot be detected with certainty. Numerous models are available that correspond to specialized survey methods such as temporally replicated surveys, distance sampling, removal sampling, and double observer sampling. These data are often associated with metadata related to the design of the study. For example, in distance sampling, the study design (line- or point-transect), distance class break points, transect lengths, and units of measurement need to be accounted for in the analysis. Unmarked uses S4 classes to store data and metadata in a way that allows for easy data manipulation, summarization, and model specification. Table 1 lists the currently implemented models and their associated fitting functions and data classes.</p>
<table class="table">
<caption>Table 1. Models handled by unmarked.</caption>
<colgroup>
<col width="32%">
<col width="18%">
<col width="21%">
<col width="28%">
</colgroup>
<thead><tr class="header">
<th align="left">Model</th>
<th align="center">Fitting Function</th>
<th align="center">Data</th>
<th align="center">Citation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Occupancy</td>
<td align="center">occu</td>
<td align="center">unmarkedFrameOccu</td>
<td align="center"><span class="citation">MacKenzie et al. (2002)</span></td>
</tr>
<tr class="even">
<td align="left">Royle-Nichols</td>
<td align="center">occuRN</td>
<td align="center">unmarkedFrameOccu</td>
<td align="center"><span class="citation">Royle and Nichols (2003)</span></td>
</tr>
<tr class="odd">
<td align="left">Point Count</td>
<td align="center">pcount</td>
<td align="center">unmarkedFramePCount</td>
<td align="center"><span class="citation">Royle (2004a)</span></td>
</tr>
<tr class="even">
<td align="left">Distance-sampling</td>
<td align="center">distsamp</td>
<td align="center">unmarkedFrameDS</td>
<td align="center"><span class="citation">Royle et al. (2004)</span></td>
</tr>
<tr class="odd">
<td align="left">Generalized distance-sampling</td>
<td align="center">gdistsamp</td>
<td align="center">unmarkedFrameGDS</td>
<td align="center"><span class="citation">Chandler et al. (2011)</span></td>
</tr>
<tr class="even">
<td align="left">Arbitrary multinomial-Poisson</td>
<td align="center">multinomPois</td>
<td align="center">unmarkedFrameMPois</td>
<td align="center"><span class="citation">Royle (2004b)</span></td>
</tr>
<tr class="odd">
<td align="left">Colonization-extinction</td>
<td align="center">colext</td>
<td align="center">unmarkedMultFrame</td>
<td align="center"><span class="citation">MacKenzie et al. (2003)</span></td>
</tr>
<tr class="even">
<td align="left">Generalized multinomial-mixture</td>
<td align="center">gmultmix</td>
<td align="center">unmarkedFrameGMM</td>
<td align="center"><span class="citation">Royle (2004b)</span></td>
</tr>
</tbody>
</table>
<p>Each data class can be created with a call to the constructor function of the same name as described in the examples below.</p>
</div>
<div class="section level2">
<h2 id="typical-unmarked-session">Typical unmarked session<a class="anchor" aria-label="anchor" href="#typical-unmarked-session"></a>
</h2>
<p>The first step is to import the data into R, which we do below using the <code>read.csv</code> function. Next, the data need to be formatted for use with a specific model fitting function. This can be accomplished with a call to the appropriate type of <code>unmarkedFrame</code>. For example, to prepare the data for a single-season site-occupancy analysis, the function <code>unmarkedFrameOccu</code> is used.</p>
<div class="section level3">
<h3 id="importing-and-formatting-data">Importing and formatting data<a class="anchor" aria-label="anchor" href="#importing-and-formatting-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://groups.google.com/d/forum/unmarked" class="external-link">unmarked</a></span><span class="op">)</span></span>
<span><span class="va">wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"csv"</span>,<span class="st">"widewt.csv"</span>, package<span class="op">=</span><span class="st">"unmarked"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">wt</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">siteCovs</span> <span class="op">&lt;-</span>  <span class="va">wt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"elev"</span>, <span class="st">"forest"</span>, <span class="st">"length"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">obsCovs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>date<span class="op">=</span><span class="va">wt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date.1"</span>, <span class="st">"date.2"</span>, <span class="st">"date.3"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    ivel<span class="op">=</span><span class="va">wt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ivel.1"</span>,  <span class="st">"ivel.2"</span>, <span class="st">"ivel.3"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unmarkedFrameOccu.html">unmarkedFrameOccu</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, siteCovs <span class="op">=</span> <span class="va">siteCovs</span>, obsCovs <span class="op">=</span> <span class="va">obsCovs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## unmarkedFrame Object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 237 sites</span></span>
<span><span class="co">## Maximum number of observations per site: 3 </span></span>
<span><span class="co">## Mean number of observations per site: 2.81 </span></span>
<span><span class="co">## Sites with at least one detection: 79 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Tabulation of y observations:</span></span>
<span><span class="co">##    0    1 &lt;NA&gt; </span></span>
<span><span class="co">##  483  182   46 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Site-level covariates:</span></span>
<span><span class="co">##       elev               forest              length      </span></span>
<span><span class="co">##  Min.   :-1.436125   Min.   :-1.265352   Min.   :0.1823  </span></span>
<span><span class="co">##  1st Qu.:-0.940726   1st Qu.:-0.974355   1st Qu.:1.4351  </span></span>
<span><span class="co">##  Median :-0.166666   Median :-0.064987   Median :1.6094  </span></span>
<span><span class="co">##  Mean   : 0.007612   Mean   : 0.000088   Mean   :1.5924  </span></span>
<span><span class="co">##  3rd Qu.: 0.994425   3rd Qu.: 0.808005   3rd Qu.:1.7750  </span></span>
<span><span class="co">##  Max.   : 2.434177   Max.   : 2.299367   Max.   :2.2407  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Observation-level covariates:</span></span>
<span><span class="co">##       date               ivel        </span></span>
<span><span class="co">##  Min.   :-2.90434   Min.   :-1.7533  </span></span>
<span><span class="co">##  1st Qu.:-1.11862   1st Qu.:-0.6660  </span></span>
<span><span class="co">##  Median :-0.11862   Median :-0.1395  </span></span>
<span><span class="co">##  Mean   :-0.00022   Mean   : 0.0000  </span></span>
<span><span class="co">##  3rd Qu.: 1.30995   3rd Qu.: 0.5493  </span></span>
<span><span class="co">##  Max.   : 3.80995   Max.   : 5.9795  </span></span>
<span><span class="co">##  NA's   :42         NA's   :46</span></span></code></pre>
<p>Alternatively, the convenience function <code>csvToUMF</code> can be used</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/csvToUMF.html">csvToUMF</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"csv"</span>,<span class="st">"widewt.csv"</span>, package<span class="op">=</span><span class="st">"unmarked"</span><span class="op">)</span>,</span>
<span>               long <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="st">"unmarkedFrameOccu"</span><span class="op">)</span></span></code></pre></div>
<p>If not all sites have the same numbers of observations, then manual importation of data in long format can be tricky. <code>csvToUMF</code> seamlessly handles this situation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcru</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/csvToUMF.html">csvToUMF</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"csv"</span>,<span class="st">"frog2001pcru.csv"</span>, package<span class="op">=</span><span class="st">"unmarked"</span><span class="op">)</span>,</span>
<span>                 long <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"unmarkedFrameOccu"</span><span class="op">)</span></span></code></pre></div>
<p>To help stabilize the numerical optimization algorithm, we recommend standardizing the covariates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/unmarkedFrame-class.html">obsCovs</a></span><span class="op">(</span><span class="va">pcru</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="../reference/unmarkedFrame-class.html">obsCovs</a></span><span class="op">(</span><span class="va">pcru</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fitting-models">Fitting models<a class="anchor" aria-label="anchor" href="#fitting-models"></a>
</h3>
<p>Occupancy models can then be fit with the occu() function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occu.html">occu</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span> <span class="op">~</span><span class="fl">1</span>, <span class="va">pcru</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in truncateToBinary(designMats$y): Some observations were &gt; 1.  These</span></span>
<span><span class="co">## were truncated to 1.</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occu.html">occu</a></span><span class="op">(</span><span class="op">~</span> <span class="va">MinAfterSunset</span> <span class="op">+</span> <span class="va">Temperature</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">pcru</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in truncateToBinary(designMats$y): Some observations were &gt; 1.  These</span></span>
<span><span class="co">## were truncated to 1.</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm2</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## occu(formula = ~MinAfterSunset + Temperature ~ 1, data = pcru)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Occupancy:</span></span>
<span><span class="co">##  Estimate    SE    z  P(&gt;|z|)</span></span>
<span><span class="co">##      1.54 0.292 5.26 1.42e-07</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection:</span></span>
<span><span class="co">##                Estimate    SE      z  P(&gt;|z|)</span></span>
<span><span class="co">## (Intercept)      0.2098 0.206  1.017 3.09e-01</span></span>
<span><span class="co">## MinAfterSunset  -0.0855 0.160 -0.536 5.92e-01</span></span>
<span><span class="co">## Temperature     -1.8936 0.291 -6.508 7.60e-11</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## AIC: 356.7591</span></span></code></pre>
<p>Here, we have specified that the detection process is modeled with the <code>MinAfterSunset</code> and <code>Temperature</code> covariates. No covariates are specified for occupancy here. See <code><a href="../reference/occu.html">?occu</a></code> for more details.</p>
</div>
<div class="section level3">
<h3 id="back-transforming-parameter-estimates">Back-transforming parameter estimates<a class="anchor" aria-label="anchor" href="#back-transforming-parameter-estimates"></a>
</h3>
<p><code>unmarked</code> fitting functions return <code>unmarkedFit</code> objects which can be queried to investigate the model fit. Variables can be back-transformed to the unconstrained scale using <code>backTransform</code>. Standard errors are computed using the delta method.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/backTransform-methods.html">backTransform</a></span><span class="op">(</span><span class="va">fm2</span>, <span class="st">'state'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Backtransformed linear combination(s) of Occupancy estimate(s)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Estimate     SE LinComb (Intercept)</span></span>
<span><span class="co">##     0.823 0.0425    1.54           1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformation: logistic</span></span></code></pre>
<p>The expected probability that a site was occupied is 0.823. This estimate applies to the hypothetical population of all possible sites, not the sites found in our sample. For a good discussion of population-level vs finite-sample inference, see <span class="citation">Royle and Dorazio (2008)</span> page 117. Note also that finite-sample quantities can be computed in <code>unmarked</code> using empirical Bayes methods as demonstrated at the end of this document.</p>
<p>Back-transforming the estimate of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ïˆ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math> was easy because there were no covariates. Because the detection component was modeled with covariates, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> is a function, not just a scalar quantity, and so we need to be provide values of our covariates to obtain an estimate of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>. Here, we request the probability of detection given a site is occupied and all covariates are set to 0.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/backTransform-methods.html">backTransform</a></span><span class="op">(</span><span class="fu"><a href="../reference/linearComb-methods.html">linearComb</a></span><span class="op">(</span><span class="va">fm2</span>, coefficients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'det'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Backtransformed linear combination(s) of Detection estimate(s)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Estimate    SE LinComb (Intercept) MinAfterSunset Temperature</span></span>
<span><span class="co">##     0.552 0.051    0.21           1              0           0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformation: logistic</span></span></code></pre>
<p>Thus, we can say that the expected probability of detection was 0.552 when time of day and temperature are fixed at their mean value. A <code>predict</code> method also exists, which can be used to obtain estimates of parameters at specific covariate values.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>MinAfterSunset <span class="op">=</span> <span class="fl">0</span>, Temperature <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/predict-methods.html">predict</a></span><span class="op">(</span><span class="va">fm2</span>, type <span class="op">=</span> <span class="st">'det'</span>, newdata <span class="op">=</span> <span class="va">newData</span>, appendData<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Predicted   SE lower upper MinAfterSunset Temperature</span></span>
<span><span class="co">## 1      0.98 0.01  0.93  1.00              0          -2</span></span>
<span><span class="co">## 2      0.89 0.04  0.78  0.95              0          -1</span></span>
<span><span class="co">## 3      0.55 0.05  0.45  0.65              0           0</span></span>
<span><span class="co">## 4      0.16 0.03  0.10  0.23              0           1</span></span>
<span><span class="co">## 5      0.03 0.01  0.01  0.07              0           2</span></span></code></pre>
<p>Confidence intervals are requested with <code>confint</code>, using either the asymptotic normal approximation or profiling.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fm2</span>, type<span class="op">=</span><span class="st">'det'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fm2</span>, type<span class="op">=</span><span class="st">'det'</span>, method <span class="op">=</span> <span class="st">"profile"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                        0.025      0.975</span></span>
<span><span class="co">## p(Int)            -0.1946871  0.6142292</span></span>
<span><span class="co">## p(MinAfterSunset) -0.3985642  0.2274722</span></span>
<span><span class="co">## p(Temperature)    -2.4638797 -1.3233511</span></span></code></pre>
<pre><code><span><span class="co">##                        0.025      0.975</span></span>
<span><span class="co">## p(Int)            -0.1929210  0.6208837</span></span>
<span><span class="co">## p(MinAfterSunset) -0.4044794  0.2244221</span></span>
<span><span class="co">## p(Temperature)    -2.5189984 -1.3789261</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="model-selection-and-model-fit">Model selection and model fit<a class="anchor" aria-label="anchor" href="#model-selection-and-model-fit"></a>
</h3>
<p>Model selection and multi-model inference can be implemented after organizing models using the <code>fitList</code> function.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitList.html">fitList</a></span><span class="op">(</span><span class="st">'psi(.)p(.)'</span> <span class="op">=</span> <span class="va">fm1</span>, <span class="st">'psi(.)p(Time+Temp)'</span> <span class="op">=</span> <span class="va">fm2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/modSel.html">modSel</a></span><span class="op">(</span><span class="va">fms</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    nPars    AIC  delta   AICwt cumltvWt</span></span>
<span><span class="co">## psi(.)p(Time+Temp)     4 356.76   0.00 1.0e+00     1.00</span></span>
<span><span class="co">## psi(.)p(.)             2 461.00 104.25 2.3e-23     1.00</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict-methods.html">predict</a></span><span class="op">(</span><span class="va">fms</span>, type<span class="op">=</span><span class="st">'det'</span>, newdata <span class="op">=</span> <span class="va">newData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Predicted         SE     lower      upper</span></span>
<span><span class="co">## 1 0.98196076 0.01266193 0.9306044 0.99549474</span></span>
<span><span class="co">## 2 0.89123189 0.04248804 0.7763166 0.95084836</span></span>
<span><span class="co">## 3 0.55225129 0.05102660 0.4514814 0.64890493</span></span>
<span><span class="co">## 4 0.15658708 0.03298276 0.1021713 0.23248007</span></span>
<span><span class="co">## 5 0.02718682 0.01326263 0.0103505 0.06948653</span></span></code></pre>
<p>The parametric bootstrap can be used to check the adequacy of model fit. Here we use a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Ï‡</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math> statistic appropriate for binary data.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chisq</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fm</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">umf</span> <span class="op">&lt;-</span> <span class="va">fm</span><span class="op">@</span><span class="va">data</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">umf</span><span class="op">@</span><span class="va">y</span></span>
<span>    <span class="va">y</span><span class="op">[</span><span class="va">y</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="va">fv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitted.html">fitted</a></span><span class="op">(</span><span class="va">fm</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">y</span><span class="op">-</span><span class="va">fv</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="va">fv</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">fv</span><span class="op">)</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parboot.html">parboot</a></span><span class="op">(</span><span class="va">fm2</span>, statistic<span class="op">=</span><span class="va">chisq</span>, nsim<span class="op">=</span><span class="fl">100</span>, parallel<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call: parboot(object = fm2, statistic = chisq, nsim = 100, parallel = FALSE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric Bootstrap Statistics:</span></span>
<span><span class="co">##    t0 mean(t0 - t_B) StdDev(t0 - t_B) Pr(t_B &gt; t0)</span></span>
<span><span class="co">## 1 356           17.2             18.3        0.139</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## t_B quantiles:</span></span>
<span><span class="co">##       0% 2.5% 25% 50% 75% 97.5% 100%</span></span>
<span><span class="co">## [1,] 309  311 325 337 348   381  404</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## t0 = Original statistic computed from data</span></span>
<span><span class="co">## t_B = Vector of bootstrap samples</span></span></code></pre>
<p>We fail to reject the null hypothesis, and conclude that the model fit is adequate.</p>
</div>
<div class="section level3">
<h3 id="derived-parameters-and-empirical-bayes-methods">Derived parameters and empirical Bayes methods<a class="anchor" aria-label="anchor" href="#derived-parameters-and-empirical-bayes-methods"></a>
</h3>
<p>The <code>parboot</code> function can be also be used to compute confidence intervals for estimates of derived parameters, such as the proportion of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> sites occupied <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">PAO</mtext><mo>=</mo><mfrac><mrow><msub><mo>âˆ‘</mo><mi>i</mi></msub><msub><mi>z</mi><mi>i</mi></msub></mrow><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">\mbox{PAO} = \frac{\sum_i z_i}{N}</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>i</mi></msub><annotation encoding="application/x-tex">z_i</annotation></semantics></math> is the true occurrence state at site <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>, which is unknown at sites where no individuals were detected. The <code>colext</code> vignette shows examples of using <code>parboot</code> to obtain confidence intervals for such derived quantities. An alternative way achieving this goal is to use empirical Bayes methods, which were introduced in <code>unmarked</code> version 0.9-5. These methods estimate the posterior distribution of the latent variable given the data and the estimates of the fixed effects (the MLEs). The mean or the mode of the estimated posterior distibution is referred to as the empirical best unbiased predictor (EBUP), which in <code>unmarked</code> can be obtained by applying the <code>bup</code> function to the estimates of the posterior distributions returned by the <code>ranef</code> function. The following code returns an estimate of PAO using EBUP.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">re</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ranef-methods.html">ranef</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span><span class="va">EBUP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unmarkedRanef-class.html">bup</a></span><span class="op">(</span><span class="va">re</span>, stat<span class="op">=</span><span class="st">"mode"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">EBUP</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/unmarkedFrame-class.html">numSites</a></span><span class="op">(</span><span class="va">pcru</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.8076923</span></span></code></pre>
<p>Note that this is similar, but slightly lower than the population-level estimate of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ïˆ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math> obtained above.</p>
<p>A plot method also exists for objects returned by <code>ranef</code>, but distributions of binary variables are not so pretty. Try it out on a fitted abundance model instead.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-chandlerEA_2011">
<p>Chandler, R. B., J. A. Royle, and D. I. King. 2011. Inference about density and temporary emigration in unmarked populations. Ecology 92:1429â€“1435.</p>
</div>
<div id="ref-fiskeChandler_2011">
<p>Fiske, I., and R. Chandler. 2011. <strong>Unmarked</strong>: An <strong>R</strong> package for fitting hierarchical models of wildlife occurrence and abundance. Journal of Statistical Software 43:1â€“23.</p>
</div>
<div id="ref-mackenzie_estimating_2003">
<p>MacKenzie, D. I., J. D. Nichols, J. E. Hines, M. G. Knutson, and A. B. Franklin. 2003. Estimating site occupancy, colonization, and local extinction when a species is detected imperfectly. Ecology 84:2200â€“2207.</p>
</div>
<div id="ref-mackenzie_estimating_2002">
<p>MacKenzie, D. I., J. D. Nichols, G. B. Lachman, S. Droege, J. A. Royle, and C. A. Langtimm. 2002. Estimating site occupancy rates when detection probabilities are less than one. Ecology 83:2248â€“2255.</p>
</div>
<div id="ref-royle_n-mixture_2004">
<p>Royle, J. A. 2004a. N-mixture models for estimating population size from spatially replicated counts. Biometrics 60:108â€“115.</p>
</div>
<div id="ref-royle_generalized_2004">
<p>Royle, J. A. 2004b. Generalized estimators of avian abundance from count survey data. Animal Biodiversity and Conservation 27:375â€“386.</p>
</div>
<div id="ref-royle_modeling_2004">
<p>Royle, J. A., D. K. Dawson, and S. Bates. 2004. Modeling abundance effects in distance sampling. Ecology 85:1591â€“1597.</p>
</div>
<div id="ref-royle_dorazio:2008">
<p>Royle, J. A., and R. M. Dorazio. 2008. Hierarchical modeling and inference in ecology: The analysis of data from populations, metapopulations and communities. Academic Press.</p>
</div>
<div id="ref-royle_estimating_2003">
<p>Royle, J. A., and J. D. Nichols. 2003. Estimating abundance from repeated presence-absence data or point counts. Ecology 84:777â€“790.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://chandlerlab.uga.edu/richard-chandler-phd/" class="external-link">Richard Chandler</a>, <a href="https://kenkellner.com" class="external-link">Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith, Lea Pautrel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
