<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distance sampling analysis in unmarked • unmarked</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Distance sampling analysis in unmarked">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/unmarked.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cap-recap.html">Modeling variation in abundance using capture-recapture data</a>
    </li>
    <li>
      <a href="../articles/colext.html">Dynamic occupancy models in unmarked</a>
    </li>
    <li>
      <a href="../articles/contributing_to_unmarked.html">Contributing to unmarked: guide to adding a new model to `unmarked`</a>
    </li>
    <li>
      <a href="../articles/distsamp.html">Distance sampling analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/occuMulti.html">Multispecies occupancy models with occuMulti</a>
    </li>
    <li>
      <a href="../articles/powerAnalysis.html">Power Analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/simulate.html">Simulating datasets</a>
    </li>
    <li>
      <a href="../articles/spp-dist.html">Modeling and mapping species distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hmecology/unmarked/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="distsamp_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Distance sampling analysis in unmarked</h1>
                        <h4 data-toc-skip class="author">Richard Chandler, USGS Patuxent Wildlife Research Center</h4>
            
            <h4 data-toc-skip class="date">March 4, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hmecology/unmarked/blob/HEAD/vignettes/distsamp.Rmd" class="external-link"><code>vignettes/distsamp.Rmd</code></a></small>
      <div class="hidden name"><code>distsamp.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>Distance sampling is a wildlife sampling technique used to estimate population size or density. Describing how density varies spatially is often of equal interest; however, conventional methods of analysis do not allow for explicit modeling of both density and detection probability. The function <code>distsamp</code> implements the multinomial-Poisson mixture model of <span class="citation">Royle et al. (2004)</span>, which was developed to overcome this limitation. This model requires that line- or point-transects are spatially replicated and that distance data are recorded in discrete intervals. The function  extends this basic model, by introducing the parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>, the probability of being available for detection <span class="citation">(Chandler et al. 2011)</span>. Furthermore, this function allows abundance to be modeled using the negative binomial distribution, which may be useful for dealing with over-dispersion. This document describes how to format data, fit models, and manipulate results in package . It does not cover the statistical theory and assumptions underlying distance sampling <span class="citation">(Buckland et al. 2001)</span>, which the user is expected to be familiar with.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Spatial variation in density is common to virtually all wildlife populations, and describing this variation is a central objective of much research. To accurately estimate and model density, it is often necessary to account for individuals present but not detected. Distance from observer is a ubiquitous source of variation in detection probability, and thus distance sampling has become a commonly used survey methodology. Numerous options exist for analyzing distance sampling data, but here the focus is on the model of <span class="citation">Royle et al. (2004)</span>, which assumes that multiple transects have been surveyed and distance data are recorded in discrete intervals. The details of the model formulation are as follows:</p>
<p>The latent transect-level abundance distribution is currently assumed to be <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mo>∼</mo><mstyle mathvariant="normal"><mi>P</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>s</mi><mi>o</mi><mi>n</mi></mstyle><mo stretchy="false" form="prefix">(</mo><mi>λ</mi><mo stretchy="false" form="postfix">)</mo><mspace width="1.0em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>M</mi><mspace width="0.222em"></mspace></mrow><annotation encoding="application/x-tex">
  \label{eq:1}
  N_{i} \sim \mathrm{Poisson}(\lambda)
  \quad  i=1,\dots,M\
</annotation></semantics></math> The detection process is modeled as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mstyle mathvariant="normal"><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>i</mi><mi>a</mi><mi>l</mi></mstyle><mo stretchy="false" form="prefix">(</mo><msub><mi>N</mi><mi>i</mi></msub><mo>,</mo><msub><mi>π</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo><mspace width="1.0em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>M</mi><mspace width="0.278em"></mspace><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">
  \label{eq:2}
  y_{ij} \sim \mathrm{Multinomial}(N_{i}, \pi_{ij})
  \quad  i=1,\dots,M\;j=1,\dots,J
</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>π</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\pi_{ij}</annotation></semantics></math> is the multinomial cell probability for transect <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> in distance class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>. These are computed by integrating a detection function such as the half-normal (with scale parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>) over each distance interval.</p>
<p>Parameters <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math> can be vectors affected by transect-specific covariates using the log link.</p>
</div>
<div class="section level2">
<h2 id="importing-formatting-and-summarizing-data">Importing, formatting, and summarizing data<a class="anchor" aria-label="anchor" href="#importing-formatting-and-summarizing-data"></a>
</h2>
<p>The first step is to import the data into R. The simplest option is to use the <code>read.csv</code> function to import a .csv file that has been formatted so that each row represents a transect, and columns describe either the number of individuals detected in each distance interval or transect-specific covariates. Alternatively, if data were not recorded in discrete distance intervals, a .csv file could be imported that contains a row for each individual detected and columns for the distances and transect names. This could then be converted to transect-level data using the function <code>formatDistData</code>. For example,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://groups.google.com/d/forum/unmarked" class="external-link">unmarked</a></span><span class="op">)</span></span>
<span><span class="va">dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"csv"</span>, <span class="st">"distdata.csv"</span>, package<span class="op">=</span><span class="st">"unmarked"</span><span class="op">)</span>,</span>
<span>                  stringsAsFactors<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dists</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    distance transect</span></span>
<span><span class="co">## 1         1        a</span></span>
<span><span class="co">## 2        18        a</span></span>
<span><span class="co">## 3         7        a</span></span>
<span><span class="co">## 4         2        a</span></span>
<span><span class="co">## 5        13        b</span></span>
<span><span class="co">## 6         3        b</span></span>
<span><span class="co">## 7         5        b</span></span>
<span><span class="co">## 8        10        b</span></span>
<span><span class="co">## 9         6        c</span></span>
<span><span class="co">## 10        9        c</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">dists</span><span class="op">$</span><span class="va">transect</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">dists</span><span class="op">$</span><span class="va">transect</span><span class="op">)</span>, <span class="st">"g"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">dists</span><span class="op">$</span><span class="va">transect</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "a" "b" "c" "d" "e" "f" "g"</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">yDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formatDistData.html">formatDistData</a></span><span class="op">(</span><span class="va">dists</span>, distCol<span class="op">=</span><span class="st">"distance"</span>,</span>
<span>    transectNameCol<span class="op">=</span><span class="st">"transect"</span>, dist.breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yDat</span></span></code></pre></div>
<pre><code><span><span class="co">##   [0,5] (5,10] (10,15] (15,20]</span></span>
<span><span class="co">## a     2      1       0       1</span></span>
<span><span class="co">## b     2      1       1       0</span></span>
<span><span class="co">## c     2      2       0       0</span></span>
<span><span class="co">## d     2      1       1       0</span></span>
<span><span class="co">## e     1      0       1       2</span></span>
<span><span class="co">## f     2      1       1       0</span></span>
<span><span class="co">## g     0      0       0       0</span></span></code></pre>
<p>Here we have created an object called <code>yDat</code> that contains counts for each transect (row) in each distance interval (columns). Note the method used to include transect <code>"g"</code>, which was surveyed but where no individuals were detected. It is important that all surveyed transects are included in the analysis.</p>
<p>Suppose there also exists transect-specific covariate data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">covs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>canopyHt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>    habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'B'</span><span class="op">)</span>, row.names<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   canopyHt habitat</span></span>
<span><span class="co">## a        5       A</span></span>
<span><span class="co">## b        8       A</span></span>
<span><span class="co">## c        3       A</span></span>
<span><span class="co">## d        2       A</span></span>
<span><span class="co">## e        4       B</span></span>
<span><span class="co">## f        7       B</span></span>
<span><span class="co">## g        5       B</span></span></code></pre>
<p>The function <code>unmarkedFrameDS</code> can now be used to organize these data along with their metadata (study design (line- or point-transect), distance class break points, transect lengths, and units of measurement) into an object to be used as the <code>data</code> argument in <code>distsamp</code>. By organizing the data this way, the user does not need to repetitively specify these arguments during each call to <code>distsamp</code>, thereby reducing the potential for errors and facilitating data summary and manipulation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">umf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unmarkedFrameDS.html">unmarkedFrameDS</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">yDat</span><span class="op">)</span>, siteCovs<span class="op">=</span><span class="va">covs</span>, survey<span class="op">=</span><span class="st">"line"</span>,</span>
<span>    dist.breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>, tlength<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>    unitsIn<span class="op">=</span><span class="st">"m"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: siteCovs contains characters. Converting them to factors.</span></span></code></pre>
<p>Note that there is no <code>obsCovs</code> argument, meaning that distance-interval-level covariates cannot be included in the analysis. The call to <code>unmarkedFrameDS</code> indicates that the data were collected on seven line transects, each 100 meters long, and detections were tabulated into distance intervals defined by the <code>dist.breaks</code> cutpoints. It is important that both transect lengths and distance break points are provided in the same units specified by <code>unitsIn</code>.</p>
<p>We can look at these data using a variety of methods.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">umf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## unmarkedFrameDS Object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## line-transect survey design</span></span>
<span><span class="co">## Distance class cutpoints (m):  0 5 10 15 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 7 sites</span></span>
<span><span class="co">## Maximum number of distance classes per site: 4 </span></span>
<span><span class="co">## Mean number of distance classes per site: 4 </span></span>
<span><span class="co">## Sites with at least one detection: 6 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Tabulation of y observations:</span></span>
<span><span class="co">##  0  1  2 </span></span>
<span><span class="co">## 11 10  7 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Site-level covariates:</span></span>
<span><span class="co">##     canopyHt     habitat</span></span>
<span><span class="co">##  Min.   :2.000   A:4    </span></span>
<span><span class="co">##  1st Qu.:3.500   B:3    </span></span>
<span><span class="co">##  Median :5.000          </span></span>
<span><span class="co">##  Mean   :4.857          </span></span>
<span><span class="co">##  3rd Qu.:6.000          </span></span>
<span><span class="co">##  Max.   :8.000</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">umf</span>, xlab<span class="op">=</span><span class="st">"distance (m)"</span>, main<span class="op">=</span><span class="st">""</span>, cex.lab<span class="op">=</span><span class="fl">0.8</span>, cex.axis<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="distsamp_files/figure-html/unnamed-chunk-5-1.png" alt="Figure 1. Histogram of detection distances" width="384"><p class="caption">
Figure 1. Histogram of detection distances
</p>
</div>
</div>
<div class="section level2">
<h2 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<p>Now that we have put our data into an object of class <code>unmarkedFrameDS</code>, we are ready to fit some models with <code>distsamp</code>. The first argument is a <code>formula</code> which specifies the detection covariates followed by the density (or abundance) covariates. The only other required argument is the <code>data</code>, but several other optional arguments exist. By default, the half-normal detection function is used to model density in animals / ha. The detection function can be selected using the <code>keyfun</code> argument. The response can be changed from <code>"density"</code>, to <code>"abund"</code> with the <code>output</code> argument. When modeling density, the output units can be changed from <code>"ha"</code> to <code>"kmsq"</code> using the <code>unitsOut</code> argument. <code>distsamp</code> also includes the arguments <code>starts</code>, <code>method</code>, and <code>control</code>, which are common to all unmarked fitting functions.</p>
<p>Below is a series of models that demonstrates <code>distsamp</code>’s arguments and defaults.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hn_Null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distsamp.html">distsamp</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span><span class="op">~</span><span class="fl">1</span>, <span class="va">umf</span><span class="op">)</span></span>
<span><span class="va">hn_Null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distsamp.html">distsamp</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span><span class="op">~</span><span class="fl">1</span>, <span class="va">umf</span>, keyfun<span class="op">=</span><span class="st">"halfnorm"</span>, output<span class="op">=</span><span class="st">"density"</span>,</span>
<span>    unitsOut<span class="op">=</span><span class="st">"ha"</span><span class="op">)</span></span>
<span><span class="va">haz_Null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distsamp.html">distsamp</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span><span class="op">~</span><span class="fl">1</span>, <span class="va">umf</span>, keyfun<span class="op">=</span><span class="st">"hazard"</span><span class="op">)</span></span>
<span><span class="va">hn_Hab.Ht</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distsamp.html">distsamp</a></span><span class="op">(</span><span class="op">~</span><span class="va">canopyHt</span> <span class="op">~</span><span class="va">habitat</span>, <span class="va">umf</span><span class="op">)</span></span></code></pre></div>
<p>The first two models are the same, a null half-normal detection function with density returned in animals / ha (on the log-scale). The third model uses the hazard-rate detection function, and the fourth model includes covariates affecting the Poisson mean (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>) and the half-normal scale parameter (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>).</p>
<p>Once a model has been fit, typing its name will display parameter estimate information and AIC. A summary method shows extra details including the scale on which parameters were estimated and convergence results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">haz_Null</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## distsamp(formula = ~1 ~ 1, data = umf, keyfun = "hazard")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Density:</span></span>
<span><span class="co">##  Estimate    SE    z P(&gt;|z|)</span></span>
<span><span class="co">##      2.97 0.959 3.09 0.00198</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Detection:</span></span>
<span><span class="co">##  Estimate   SE     z P(&gt;|z|)</span></span>
<span><span class="co">##      1.44 2.37 0.606   0.544</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Hazard-rate(scale):</span></span>
<span><span class="co">##  Estimate   SE       z P(&gt;|z|)</span></span>
<span><span class="co">##   -0.0223 1.21 -0.0185   0.985</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## AIC: 65.17091</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="manipulating-results">Manipulating results<a class="anchor" aria-label="anchor" href="#manipulating-results"></a>
</h2>
<p>Back-transforming estimates to the original scale and obtaining standard errors via the delta method is easily accomplished:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">haz_Null</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "state" "det"   "scale"</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/backTransform-methods.html">backTransform</a></span><span class="op">(</span><span class="va">haz_Null</span>, type<span class="op">=</span><span class="st">"state"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Backtransformed linear combination(s) of Density estimate(s)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Estimate   SE LinComb (Intercept)</span></span>
<span><span class="co">##      19.4 18.6    2.97           1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformation: exp</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/backTransform-methods.html">backTransform</a></span><span class="op">(</span><span class="va">haz_Null</span>, type<span class="op">=</span><span class="st">"det"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Backtransformed linear combination(s) of Detection estimate(s)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Estimate   SE LinComb (Intercept)</span></span>
<span><span class="co">##      4.21 9.99    1.44           1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformation: exp</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/backTransform-methods.html">backTransform</a></span><span class="op">(</span><span class="va">haz_Null</span>, type<span class="op">=</span><span class="st">"scale"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Backtransformed linear combination(s) of Hazard-rate(scale) estimate(s)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Estimate   SE LinComb scale</span></span>
<span><span class="co">##     0.978 1.18 -0.0223     1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformation: exp</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/backTransform-methods.html">backTransform</a></span><span class="op">(</span><span class="fu"><a href="../reference/linearComb-methods.html">linearComb</a></span><span class="op">(</span><span class="va">hn_Hab.Ht</span><span class="op">[</span><span class="st">'det'</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Backtransformed linear combination(s) of Detection estimate(s)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Estimate   SE LinComb (Intercept) canopyHt</span></span>
<span><span class="co">##      10.3 2.54    2.33           1        5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformation: exp</span></span></code></pre>
<p>The first back-transformation returns population density, since this is the default state parameter modeled when <code>distsamp</code>’s <code>output</code> argument is set to <code>"density"</code>. The second back-transformation returns the hazard-rate shape parameter, and third is the hazard-rate scale parameter. When covariates are present, <code>backTransform</code> in conjunction with <code>linearComb</code> should be used. Here, we requested the value of sigma when canopy height was 5 meters tall. Note that the intercept was included in the calculation by setting the first value in the linear equation to 1.</p>
<p>Parameters that do not occur in the likelihood may also be of interest. For example, the number of individuals occurring in the sampled plots (local population size) is a fundamental parameter in monitoring and conservation efforts. The following commands can be used to derive this parameter from our model of density:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site.level.density</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-methods.html">predict</a></span><span class="op">(</span><span class="va">hn_Hab.Ht</span>, type<span class="op">=</span><span class="st">"state"</span><span class="op">)</span><span class="op">$</span><span class="va">Predicted</span></span>
<span><span class="va">plotArea.inHectares</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="fl">40</span> <span class="op">/</span> <span class="fl">10000</span></span>
<span><span class="va">site.level.abundance</span> <span class="op">&lt;-</span> <span class="va">site.level.density</span> <span class="op">*</span> <span class="va">plotArea.inHectares</span></span>
<span><span class="op">(</span><span class="va">N.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">site.level.abundance</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 39.06128</span></span></code></pre>
<p>To describe the uncertainty of <code>N.hat</code>, or any other derived parameter, we can use a parametric bootstrap approach. First we define a function to estimate <code>N.hat</code>, and then we apply this function to numerous models fit to data simulated from our original model.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">getN.hat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-methods.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">"state"</span><span class="op">)</span><span class="op">$</span><span class="va">Predicted</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">*</span> <span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">40</span> <span class="op">/</span> <span class="fl">10000</span><span class="op">)</span></span>
<span>    <span class="va">N.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>N.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">N.hat</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parboot.html">parboot</a></span><span class="op">(</span><span class="va">hn_Hab.Ht</span>, statistic<span class="op">=</span><span class="va">getN.hat</span>, nsim<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">pb</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call: parboot(object = hn_Hab.Ht, statistic = getN.hat, nsim = 25)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric Bootstrap Statistics:</span></span>
<span><span class="co">##         t0 mean(t0 - t_B) StdDev(t0 - t_B) Pr(t_B &gt; t0)</span></span>
<span><span class="co">## N.hat 39.1          -3.79             8.64        0.692</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## t_B quantiles:</span></span>
<span><span class="co">##      0% 2.5% 25% 50% 75% 97.5% 100%</span></span>
<span><span class="co">## [1,] 21   27  38  42  50    58   58</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## t0 = Original statistic computed from data</span></span>
<span><span class="co">## t_B = Vector of bootstrap samples</span></span></code></pre>
<p>Here, <code>t_B</code> is an approximation of the sampling distribution for <code>N.hat</code>, conditioned on our fitted model. Confidence intervals can be calculated from the quantiles of <code>t_B</code>. Note that in practice <code>nsim</code> should be set to a much larger value and a goodness-of-fit test should be performed before making inference from a fitted model. Parametric bootstrapping can be used for the latter by supplying a fit statistic such as <code>SSE</code> instead of <code>getN.hat</code>. See <code><a href="../reference/parboot.html">?parboot</a></code> and <code><a href="../articles/unmarked.html">vignette('unmarked')</a></code> for examples.</p>
</div>
<div class="section level2">
<h2 id="prediction-and-plotting">Prediction and plotting<a class="anchor" aria-label="anchor" href="#prediction-and-plotting"></a>
</h2>
<p>A <code>predict</code> method exits for all <code>unmarkedFit</code> objects, which is useful when multiple covariate combinations exist. This method also facilitates plotting. Suppose we wanted model predictions from the covariate model along the range of covariate values studied. First we need to make new <code>data.frame</code>s holding the desired covariate combinations. Note that column names must match those of the original data, and factor variables must contain the same levels.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">habConstant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>canopyHt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">8</span>, length<span class="op">=</span><span class="fl">20</span><span class="op">)</span>,</span>
<span>    habitat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"A"</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   canopyHt habitat</span></span>
<span><span class="co">## 1 2.000000       A</span></span>
<span><span class="co">## 2 2.315789       A</span></span>
<span><span class="co">## 3 2.631579       A</span></span>
<span><span class="co">## 4 2.947368       A</span></span>
<span><span class="co">## 5 3.263158       A</span></span>
<span><span class="co">## 6 3.578947       A</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">htConstant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>canopyHt <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    habitat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   canopyHt habitat</span></span>
<span><span class="co">## 1        5       A</span></span>
<span><span class="co">## 2        5       B</span></span></code></pre>
<p>Now <code>predict</code> can be used to estimate density and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math> for each row of our new <code>data.frame</code>s.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">Elambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-methods.html">predict</a></span><span class="op">(</span><span class="va">hn_Hab.Ht</span>, type<span class="op">=</span><span class="st">"state"</span>, newdata<span class="op">=</span><span class="va">htConstant</span>,</span>
<span>    appendData<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Predicted       SE    lower    upper canopyHt habitat</span></span>
<span><span class="co">## 1  16.22835 5.058481 8.809465 29.89506        5       A</span></span>
<span><span class="co">## 2  10.91326 4.370499 4.978158 23.92436        5       B</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Esigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict-methods.html">predict</a></span><span class="op">(</span><span class="va">hn_Hab.Ht</span>, type<span class="op">=</span><span class="st">"det"</span>, newdata<span class="op">=</span><span class="va">habConstant</span>,</span>
<span>    appendData<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Predicted       SE    lower    upper canopyHt habitat</span></span>
<span><span class="co">## 1  10.76998 4.259542 4.960935 23.38117 2.000000       A</span></span>
<span><span class="co">## 2  10.72259 3.968438 5.191220 22.14777 2.315789       A</span></span>
<span><span class="co">## 3  10.67541 3.693948 5.418117 21.03394 2.631579       A</span></span>
<span><span class="co">## 4  10.62844 3.439012 5.637007 20.03965 2.947368       A</span></span>
<span><span class="co">## 5  10.58167 3.207199 5.842026 19.16659 3.263158       A</span></span>
<span><span class="co">## 6  10.53511 3.002718 6.026005 18.41826 3.578947       A</span></span></code></pre>
<p>Once predictions have been made, plotting is straight-forward. Figure 2a shows density as a function of habitat type, and Figure 2b shows that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math> is not related to canopy height.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Elambda</span>, <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">Predicted</span>, names<span class="op">=</span><span class="va">habitat</span>, xlab<span class="op">=</span><span class="st">"Habitat"</span>,</span>
<span>        ylab<span class="op">=</span><span class="st">"Density (animals / ha)"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">25</span><span class="op">)</span>, cex.names<span class="op">=</span><span class="fl">0.7</span>,</span>
<span>        cex.lab<span class="op">=</span><span class="fl">0.7</span>, cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">Predicted</span>, <span class="va">x</span>, <span class="va">Predicted</span><span class="op">+</span><span class="va">SE</span>, code<span class="op">=</span><span class="fl">3</span>, angle<span class="op">=</span><span class="fl">90</span>, length<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Esigma</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">canopyHt</span>, <span class="va">Predicted</span>, type<span class="op">=</span><span class="st">"l"</span>, xlab<span class="op">=</span><span class="st">"Canopy height"</span>,</span>
<span>        ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Half-normal scale parameter ("</span>, <span class="va">sigma</span>, <span class="st">")"</span>,</span>
<span>        sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.7</span>, cex.lab<span class="op">=</span><span class="fl">0.7</span>,</span>
<span>    cex.axis<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">canopyHt</span>, <span class="va">Predicted</span><span class="op">+</span><span class="va">SE</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">canopyHt</span>, <span class="va">Predicted</span><span class="op">-</span><span class="va">SE</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="distsamp_files/figure-html/unnamed-chunk-13-1.png" alt="Figure 2. Predicted covariate relationships" width="576"><p class="caption">
Figure 2. Predicted covariate relationships
</p>
</div>
<p>Plots of the detection function parameters can be less informative than plots of the detection functions themselves. To do the latter, we can plug predicted values of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math> at given covariate values into the <code>gxhn</code> function. For instance, Figure 3a shows to the half-normal function at a canopy height of 2m. This was plotted by setting <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math> to 10.8, the predicted value shown above. The available detection functions are described on the <code>detFuns</code> help page. Probability density functions such as <code>dxhn</code> can be plotted with the distance histogram using the <code>hist</code> method for <code>unmarkedFitDS</code> objects (Figure 3b). This only works for models without detection covariates; however, probability density functions at specific covariate values can be added in a fashion similar to that above (Figure 3b).</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/detFuns.html">gxhn</a></span><span class="op">(</span><span class="va">x</span>, sigma<span class="op">=</span><span class="fl">10.8</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">20</span>, xlab<span class="op">=</span><span class="st">"Distance (m)"</span>,</span>
<span>    ylab<span class="op">=</span><span class="st">"Detection prob. at 2m canopy ht."</span>, cex.lab<span class="op">=</span><span class="fl">0.7</span>,</span>
<span>    cex.axis<span class="op">=</span><span class="fl">0.7</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">hn_Null</span>, xlab<span class="op">=</span><span class="st">"Distance (m)"</span>, ylab<span class="op">=</span><span class="st">"Probability density"</span>, main<span class="op">=</span><span class="st">""</span>,</span>
<span>    ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>, cex.lab<span class="op">=</span><span class="fl">0.7</span>, cex.axis<span class="op">=</span><span class="fl">0.7</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/detFuns.html">dxhn</a></span><span class="op">(</span><span class="va">x</span>, sigma<span class="op">=</span><span class="fl">10.8</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">20</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/detFuns.html">dxhn</a></span><span class="op">(</span><span class="va">x</span>, sigma<span class="op">=</span><span class="fl">9.9</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">20</span>, add<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Canopy ht. = 2m"</span>, <span class="st">"Null"</span>, <span class="st">"Canopy ht. = 8m"</span><span class="op">)</span>,</span>
<span>    col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"green"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, cex<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="distsamp_files/figure-html/unnamed-chunk-14-1.png" alt="Figure 3. Detection and probability density functions" width="576"><p class="caption">
Figure 3. Detection and probability density functions
</p>
</div>
</div>
<div class="section level2">
<h2 id="model-extensions">Model extensions<a class="anchor" aria-label="anchor" href="#model-extensions"></a>
</h2>
<p>A common criticism of distance sampling is that all individuals must be available for detection. Similarly, the probability of detecting an individual a distance of 0 must be 1. These assumptions often cannot be met. For instance, when counting cues such as bird songs or whale blows, the probability that an individual will produce a cue (and thus be available for detection) is rarely 1 during the sampling interval. Recently developed methods <span class="citation">(Chandler et al. 2011)</span> allow for the estimation of the probability of being available for detection <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>. To do so, replicate distance sampling observations must be collected at each transect. These replicates could be collected using repeated visits or multiple observers working independently. Implementation of this model in <code>unmarked</code> is accomplished using the <code>gdistsamp</code> function. The function also provides the option to model abundance using the negative binomial distribution. Formatting data and specifying models is similar to methods described above and is more fully outlined in the help pages.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This document has emphasized methods tailored to distance sampling analysis; however, the more general methods available in package <code>unmarked</code> can also be applied to models fitted using <code>distsamp</code> and <code>gdistsamp</code>. For example, model-selection and model-averaging can be accomplished using the <code>fitList</code> function and the <code>modSel</code> and <code>predict</code> methods.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-buckland_distsamp_2001">
<p>Buckland, S. T., D. R. Anderson, K. P. Burnham, J. L. Laake, D. L. Borchers, and L. Thomas. 2001. Introduction to distance sampling – estimating abundance of biological populations. Oxford University Press.</p>
</div>
<div id="ref-chandlerEA_2011">
<p>Chandler, R. B., J. A. Royle, and D. I. King. 2011. Inference about density and temporary emigration in unmarked populations. Ecology 92:1429–1435.</p>
</div>
<div id="ref-royle_modeling_2004">
<p>Royle, J. A., D. K. Dawson, and S. Bates. 2004. Modeling abundance effects in distance sampling. Ecology 85:1591–1597.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://chandlerlab.uga.edu/richard-chandler-phd/" class="external-link">Richard Chandler</a>, <a href="https://kenkellner.com" class="external-link">Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith, Lea Pautrel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
