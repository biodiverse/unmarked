<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Models for Data from Unmarked Animals — unmarked-package • unmarked</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Models for Data from Unmarked Animals — unmarked-package"><meta property="og:description" content="Fits hierarchical models of animal
  occurrence and abundance to data collected on species that may be
  detected imperfectly.  Models include single- and multi-season site
  occupancy models, binomial N-mixture models, and multinomial N-mixture
  models. The data can arise from survey methods such as occurrence
  sampling, temporally replicated counts, removal sampling, double
  observer sampling, and distance sampling. Parameters governing the
  state and observation processes can be modeled as functions of
  covariates. General treatment of these models can be found in
  MacKenzie et al. (2006) and Royle and Dorazio (2008). The primary
  reference for the package is Fiske and Chandler (2011)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/unmarked.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cap-recap.html">Modeling variation in abundance using capture-recapture data</a>
    </li>
    <li>
      <a href="../articles/colext.html">Dynamic occupancy models in unmarked</a>
    </li>
    <li>
      <a href="../articles/contributing_to_unmarked.html">Contributing to unmarked: guide to adding a new model to `unmarked`</a>
    </li>
    <li>
      <a href="../articles/distsamp.html">Distance sampling analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/occuComm.html">Community occupancy models with occuComm</a>
    </li>
    <li>
      <a href="../articles/occuMulti.html">Multispecies occupancy models with occuMulti</a>
    </li>
    <li>
      <a href="../articles/powerAnalysis.html">Power Analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/simulate.html">Simulating datasets</a>
    </li>
    <li>
      <a href="../articles/spp-dist.html">Modeling and mapping species distributions</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/biodiverse/unmarked/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Models for Data from Unmarked Animals</h1>

    <div class="hidden name"><code>unmarked-package.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits hierarchical models of animal
  occurrence and abundance to data collected on species that may be
  detected imperfectly.  Models include single- and multi-season site
  occupancy models, binomial N-mixture models, and multinomial N-mixture
  models. The data can arise from survey methods such as occurrence
  sampling, temporally replicated counts, removal sampling, double
  observer sampling, and distance sampling. Parameters governing the
  state and observation processes can be modeled as functions of
  covariates. General treatment of these models can be found in
  MacKenzie et al. (2006) and Royle and Dorazio (2008). The primary
  reference for the package is Fiske and Chandler (2011).</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p><!-- % Not useful information and not updated; Mike suggests taking it out. -->
<!-- %\tabular{ll}{ -->
<!-- %Package: \tab unmarked\cr -->
<!-- %Type: \tab Package\cr -->
<!-- %Version: \tab 0.12-0\cr  %% doh! -->
<!-- %License: \tab GPL (&gt;= 3)\cr -->
<!-- %} --></p>
<p><strong>Overview of Model-fitting Functions:</strong></p>
<p><code><a href="occu.html">occu</a></code> fits occurrence models with no linkage between
abundance and detection (MacKenzie et al. 2002).</p>
<p><code><a href="occuRN.html">occuRN</a></code> fits abundance models to presence/absence data by
exploiting the link between detection probability and abundance (Royle and
Nichols 2003).</p>
<p><code><a href="occuFP.html">occuFP</a></code> fits occupancy models to data characterized by
false negatives and false positive detections (e.g., Royle and Link
[2006] and Miller et al. [2011]).</p>
<p><code><a href="occuMulti.html">occuMulti</a></code> fits multi-species occupancy model of Rota et
al. [2016].</p>
<p><code><a href="colext.html">colext</a></code> fits the mutli-season occupancy model of
MacKenzie et al. (2003).</p>
<p><code><a href="pcount.html">pcount</a></code> fits N-mixture models (aka binomial mixture models) to
repeated count data (Royle 2004a, Kery et al 2005).</p>
<p><code><a href="distsamp.html">distsamp</a></code> fits the distance sampling model of
Royle et al. (2004) to distance data recorded in discrete intervals.</p>
<p><code><a href="gdistsamp.html">gdistsamp</a></code> fits the generalized distance sampling model
described by Chandler et al. (2011) to distance data recorded in
discrete intervals.</p>
<p><code><a href="gpcount.html">gpcount</a></code> fits the generalized N-mixture model
described by Chandler et al. (2011) to repeated count data collected
using the robust design.</p>
<p><code><a href="multinomPois.html">multinomPois</a></code> fits the multinomial-Poisson model of Royle (2004b)
to data collected using methods such as removal sampling or double observer
sampling.</p>
<p><code><a href="gmultmix.html">gmultmix</a></code> fits a generalized form of the multinomial-mixture model
of Royle (2004b) that allows for estimating availability and detection
probability.</p>
<p><code><a href="pcountOpen.html">pcountOpen</a></code> fits the open population model of Dail and
Madsen (2011) to repeated count data. This is a genearlized form of the
Royle (2004a) N-mixture model that includes parameters for recruitment
and apparent survival.</p>

<p><strong>Data:</strong> All data are passed to unmarked's estimation functions as
a formal S4 class called an unmarkedFrame, which has child classes
for each model type. This allows metadata (eg as distance interval cut
points, measurement units, etc...) to be stored with the response and
covariate data. See <code><a href="unmarkedFrame.html">unmarkedFrame</a></code> for a detailed
description of unmarkedFrames and how to create them.</p>
<p><strong>Model Specification:</strong>  <em>unmarked</em>'s
model-fitting functions allow specification of covariates for both the
state process and the detection process.  For two-level hierarchical
models, (eg <code><a href="occu.html">occu</a></code>, <code><a href="occuRN.html">occuRN</a></code>, <code><a href="pcount.html">pcount</a></code>,
<code><a href="multinomPois.html">multinomPois</a></code>, <code><a href="distsamp.html">distsamp</a></code>) covariates for the
detection process (at the site or observation level) and the state
process (at the site level) are specified with a double right-hand sided
formula, in that order.  Such a formula looks like</p>
<p>\(~ x1 + x2 + \ldots + x_n  ~ x_1 + x_2 + \ldots + x_n\)</p>
<p>where \(x_1\) through \(x_n\) are additive covariates of
the process of interest.  Using two tildes in a single formula
differs from standard R convention, but it is informative about the model
being fit. The meaning of these covariates, or what they
model, is full described in the help files for the individual functions
and is not the same for all functions. For models with more than two
processes (eg <code><a href="colext.html">colext</a></code>, <code><a href="gmultmix.html">gmultmix</a></code>,
<code><a href="pcountOpen.html">pcountOpen</a></code>), single right-hand sided formulas (only one
tilde) are used to model each parameter.</p>
<p><strong>Utility Functions:</strong>  <em>unmarked</em> contains several utility
functions for organizing data into the form required by its model-fitting
functions.  <code><a href="csvToUMF.html">csvToUMF</a></code> converts an appropriately
formated comma-separated values (.csv) file to a list containing the
components required by model-fitting functions.</p>
    </div>
    <div id="references">
    <h2>References</h2>


<p>Chandler, R. B., J. A. Royle, and D. I. King. 2011. Inference about
  density and temporary emigration in unmarked populations. <em>Ecology</em>
  92:1429-1435.</p>
<p>Dail, D. and L. Madsen. 2011. Models for estimating abundance from
  repeated counts of an open metapopulation. <em>Biometrics</em> 67:577-587.</p>
<p>Fiske, I. and R. B. Chandler. 2011. <em>unmarked</em>: An R package for
  fitting hierarchical models of wildlife occurrence and
  abundance. <em>Journal of Statistical Software</em> 43:1–23.</p>
<p>Kery, M., Royle, J. A., and Schmid, H. 2005 Modeling avian abundance from
  replicated counts using binomial mixture models. <em>Ecological
  Applications</em> 15:1450–1461.</p>
<p>MacKenzie, D. I., J. D. Nichols, G. B. Lachman, S. Droege,
  J. A. Royle, and C. A. Langtimm. 2002. Estimating site occupancy rates
  when detection probabilities are less than one. <em>Ecology</em> 83:
  2248–2255.</p>
<p>MacKenzie, D. I., J. D. Nichols, J. E. Hines, M. G. Knutson, and
  A. B. Franklin. 2003. Estimating site occupancy, colonization, and
  local extinction when a species is detected
  imperfectly. <em>Ecology</em> 84:2200–2207.</p>
<p>MacKenzie, D. I., J. D. Nichols, J. A. Royle, K. H. Pollock,
  L. L. Bailey, and J. E. Hines. 2006. <em>Occupancy Estimation and
    Modeling</em>. Amsterdam: Academic Press.</p>
<p>Miller, D.A., J.D. Nichols, B.T. McClintock, E.H.C. Grant, L.L. Bailey,
  and L.A. Weir. 2011. Improving occupancy estimation when two types of
  observational error occur: non-detection and species
  misidentification. <em>Ecology</em> 92:1422-1428.</p>
<p>Rota, C.T., et al. 2016. A multi-species occupancy model for two or more
  interacting species. Methods in Ecology and Evolution 7: 1164-1173.</p>
<p>Royle, J. A. 2004a. N-Mixture models for estimating population size from
  spatially replicated counts. <em>Biometrics</em> 60:108–105.</p>
<p>Royle, J. A. 2004b. Generalized estimators of avian abundance from
  count survey data. <em>Animal Biodiversity and Conservation</em>
  27:375–386.</p>
<p>Royle, J. A., D. K. Dawson, and S. Bates. 2004. Modeling abundance
  effects in distance sampling. <em>Ecology</em> 85:1591–1597.</p>
<p>Royle, J. A., and R. M. Dorazio. 2006. Hierarchical models of animal
  abundance and occurrence. <em>Journal Of Agricultural Biological And
    Environmental Statistics</em> 11:249–263.</p>
<p>Royle, J.A., and W.A. Link. 2006. Generalized site occupancy models
  allowing for false positive and false negative errors. <em>Ecology</em>
  87:835-841.</p>
<p>Royle, J. A. and R. M. Dorazio. 2008. <em>Hierarchical Modeling and
  Inference in Ecology</em>. Academic Press.</p>
<p>Royle, J. A. and J. D. Nichols. 2003. Estimating Abundance from
  Repeated Presence-Absence Data or Point Counts. <em>Ecology</em>,
  84:777–790.</p>
<p>Sillett, S. and Chandler, R.B. and Royle, J.A. and Kery, M. and
  Morrison, S.A. In Press. Hierarchical distance sampling models to
  estimate population size and habitat-specific abundance of an island
  endemic. <em>Ecological Applications</em></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ian Fiske, Richard Chandler, Andy Royle, Marc Kery, David
  Miller, and Rebecca Hutchinson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## An example site-occupancy analysis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate occupancy data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">344</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nSites</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">nReps</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>veght<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nSites</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    habitat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'B'</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">psipars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ppars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">veght</span><span class="op">+</span><span class="va">habitat</span>, <span class="va">covariates</span><span class="op">)</span> <span class="co"># design matrix</span></span></span>
<span class="r-in"><span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">psipars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">ppars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nSites</span>, <span class="va">nReps</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">nSites</span>, <span class="fl">1</span>, <span class="va">psi</span><span class="op">)</span>       <span class="co"># true occupancy state</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nSites</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">nReps</span>, <span class="fl">1</span>, <span class="va">z</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">*</span><span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize data and look at it</span></span></span>
<span class="r-in"><span><span class="va">umf</span> <span class="op">&lt;-</span> <span class="fu"><a href="unmarkedFrameOccu.html">unmarkedFrameOccu</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, siteCovs <span class="op">=</span> <span class="va">covariates</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">umf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data frame representation of unmarkedFrame object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   y.1 y.2 y.3 y.4 y.5      veght habitat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0   0   0   0   1  1.0733096       A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0   0   0   0   0  3.3024986       A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   0   0   0   0   0 -0.7308712       A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0   0   0   0   0  1.1855582       A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1   1   1   1   1  0.3037686       A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   0   1   1   1   1  0.3758026       A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   0   0   0   0   0 -1.0129665       A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached 'max' / getOption("max.print") -- omitted 3 rows ]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">umf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unmarkedFrame Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 sites</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum number of observations per site: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean number of observations per site: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sites with at least one detection: 25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tabulation of y observations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0   1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 415  85 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Site-level covariates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      veght          habitat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :-1.80746   A:50   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.:-0.75747   B:50   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median :-0.05057          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 0.07205          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 0.62237          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   : 3.32295          </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit some models</span></span></span>
<span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="occu.html">occu</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span> <span class="op">~</span><span class="fl">1</span>, <span class="va">umf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="occu.html">occu</a></span><span class="op">(</span><span class="op">~</span><span class="va">veght</span><span class="op">+</span><span class="va">habitat</span> <span class="op">~</span><span class="va">veght</span><span class="op">+</span><span class="va">habitat</span>, <span class="va">umf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="occu.html">occu</a></span><span class="op">(</span><span class="op">~</span><span class="va">veght</span> <span class="op">~</span><span class="va">veght</span><span class="op">+</span><span class="va">habitat</span>, <span class="va">umf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model selection</span></span></span>
<span class="r-in"><span><span class="va">fms</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitList.html">fitList</a></span><span class="op">(</span>m1<span class="op">=</span><span class="va">fm1</span>, m2<span class="op">=</span><span class="va">fm2</span>, m3<span class="op">=</span><span class="va">fm3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="modSel.html">modSel</a></span><span class="op">(</span><span class="va">fms</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    nPars    AIC delta   AICwt cumltvWt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m3     5 244.81  0.00 6.1e-01     0.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m2     6 245.68  0.87 3.9e-01     1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m1     2 273.01 28.20 4.6e-07     1.00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Empirical Bayes estimates of the number of sites occupied</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="bup.html">bup</a></span><span class="op">(</span><span class="fu"><a href="ranef.html">ranef</a></span><span class="op">(</span><span class="va">fm3</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">"mode"</span><span class="op">)</span><span class="op">)</span>     <span class="co"># Sum of posterior modes</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>                                <span class="co"># Actual</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model-averaged prediction and plots</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># psi in each habitat type</span></span></span>
<span class="r-in"><span><span class="va">newdata1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>habitat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span><span class="op">)</span>, veght<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Epsi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">fms</span>, type<span class="op">=</span><span class="st">"state"</span>, newdata<span class="op">=</span><span class="va">newdata1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Epsi1</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">Predicted</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        xlab<span class="op">=</span><span class="st">"Habitat"</span>,</span></span>
<span class="r-in"><span>        ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Probability of occurrence ("</span>, <span class="va">psi</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        cex.lab<span class="op">=</span><span class="fl">1.2</span>,</span></span>
<span class="r-in"><span>        pch<span class="op">=</span><span class="fl">16</span>, cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">Predicted</span><span class="op">-</span><span class="va">SE</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">Predicted</span><span class="op">+</span><span class="va">SE</span>, angle<span class="op">=</span><span class="fl">90</span>, code<span class="op">=</span><span class="fl">3</span>, length<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="unmarked-package-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># psi and p as functions of vegetation height</span></span></span>
<span class="r-in"><span><span class="va">newdata2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>habitat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">'A'</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    veght<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Epsi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">fms</span>, type<span class="op">=</span><span class="st">"state"</span>, newdata<span class="op">=</span><span class="va">newdata2</span>, appendData<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Ep</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">fms</span>, type<span class="op">=</span><span class="st">"det"</span>, newdata<span class="op">=</span><span class="va">newdata2</span>, appendData<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, mai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Predicted</span><span class="op">~</span><span class="va">veght</span>, <span class="va">Epsi2</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlab<span class="op">=</span><span class="st">"Vegetation height (standardized)"</span>,</span></span>
<span class="r-in"><span>    ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Probability of occurrence ("</span>, <span class="va">psi</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lower</span> <span class="op">~</span> <span class="va">veght</span>, <span class="va">Epsi2</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">upper</span> <span class="op">~</span> <span class="va">veght</span>, <span class="va">Epsi2</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Predicted</span><span class="op">~</span><span class="va">veght</span>, <span class="va">Ep</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlab<span class="op">=</span><span class="st">"Vegetation height (standardized)"</span>,</span></span>
<span class="r-in"><span>    ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Detection probability ("</span>, <span class="fu">italic</span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">lower</span><span class="op">~</span><span class="va">veght</span>, <span class="va">Ep</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">upper</span><span class="op">~</span><span class="va">veght</span>, <span class="va">Ep</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="unmarked-package-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://chandlerlab.uga.edu/richard-chandler-phd/" class="external-link">Richard Chandler</a>, <a href="https://kenkellner.com" class="external-link">Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith, Lea Pautrel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

