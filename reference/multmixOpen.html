<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Open population multinomial N-mixture model — multmixOpen • unmarked</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Open population multinomial N-mixture model — multmixOpen"><meta property="og:description" content="Fit the model of Dail and Madsen (2011) and Hostetler and Chandler
  (2015) for designs involving repeated counts that yield multinomial outcomes.
  Possible data collection methods include repeated removal sampling and
  double observer sampling."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/unmarked.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cap-recap.html">Modeling variation in abundance using capture-recapture data</a>
    </li>
    <li>
      <a href="../articles/colext.html">Dynamic occupancy models in unmarked</a>
    </li>
    <li>
      <a href="../articles/contributing_to_unmarked.html">Contributing to unmarked: guide to adding a new model to `unmarked`</a>
    </li>
    <li>
      <a href="../articles/distsamp.html">Distance sampling analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/occuMulti.html">Multispecies occupancy models with occuMulti</a>
    </li>
    <li>
      <a href="../articles/powerAnalysis.html">Power Analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/simulate.html">Simulating datasets</a>
    </li>
    <li>
      <a href="../articles/spp-dist.html">Modeling and mapping species distributions</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/hmecology/unmarked/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Open population multinomial N-mixture model</h1>

    <div class="hidden name"><code>multmixOpen.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit the model of Dail and Madsen (2011) and Hostetler and Chandler
  (2015) for designs involving repeated counts that yield multinomial outcomes.
  Possible data collection methods include repeated removal sampling and
  double observer sampling.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multmixOpen</span><span class="op">(</span><span class="va">lambdaformula</span>, <span class="va">gammaformula</span>, <span class="va">omegaformula</span>, <span class="va">pformula</span>,</span>
<span>    <span class="va">data</span>, mixture<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"NB"</span>, <span class="st">"ZIP"</span><span class="op">)</span>, <span class="va">K</span>,</span>
<span>    dynamics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"autoreg"</span>, <span class="st">"notrend"</span>, <span class="st">"trend"</span>, <span class="st">"ricker"</span>, <span class="st">"gompertz"</span><span class="op">)</span>,</span>
<span>    fix<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"gamma"</span>, <span class="st">"omega"</span><span class="op">)</span>, immigration<span class="op">=</span><span class="cn">FALSE</span>, iotaformula <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>    <span class="va">starts</span>, method<span class="op">=</span><span class="st">"BFGS"</span>, se<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-lambdaformula">lambdaformula<a class="anchor" aria-label="anchor" href="#arg-lambdaformula"></a></dt>
<dd><p>Right-hand sided formula for initial abundance</p></dd>

  <dt id="arg-gammaformula">gammaformula<a class="anchor" aria-label="anchor" href="#arg-gammaformula"></a></dt>
<dd><p>Right-hand sided formula for recruitment rate (when
    dynamics is "constant", "autoreg", or "notrend") or population growth rate
    (when dynamics is "trend", "ricker", or "gompertz")</p></dd>

  <dt id="arg-omegaformula">omegaformula<a class="anchor" aria-label="anchor" href="#arg-omegaformula"></a></dt>
<dd><p>Right-hand sided formula for apparent survival probability
    (when dynamics is "constant", "autoreg", or "notrend") or equilibrium
    abundance (when dynamics is "ricker" or "gompertz")</p></dd>

  <dt id="arg-pformula">pformula<a class="anchor" aria-label="anchor" href="#arg-pformula"></a></dt>
<dd><p>A right-hand side formula describing the detection
    function covariates</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>An object of class <code><a href="unmarkedFrameMMO.html">unmarkedFrameMMO</a></code></p></dd>

  <dt id="arg-mixture">mixture<a class="anchor" aria-label="anchor" href="#arg-mixture"></a></dt>
<dd><p>String specifying mixture: "P", "NB", or "ZIP" for
    the Poisson, negative binomial, or zero-inflated Poisson
    distributions respectively</p></dd>

  <dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Integer defining upper bound of discrete integration. This
    should be higher than the maximum observed count and high enough
    that it does not affect the parameter estimates. However, the higher
    the value the slower the computation</p></dd>

  <dt id="arg-dynamics">dynamics<a class="anchor" aria-label="anchor" href="#arg-dynamics"></a></dt>
<dd><p>Character string describing the type of population
    dynamics. "constant" indicates that there is no relationship between
    omega and gamma. "autoreg" is an auto-regressive model in which
    recruitment is modeled as gamma*N[i,t-1]. "notrend" model gamma as
    lambda*(1-omega) such that there is no temporal trend. "trend" is
    a model for exponential growth, N[i,t] = N[i,t-1]*gamma, where gamma
    in this case is finite rate of increase (normally referred to as
    lambda). "ricker" and "gompertz" are models for density-dependent
    population growth.  "ricker" is the Ricker-logistic model, N[i,t] =
    N[i,t-1]*exp(gamma*(1-N[i,t-1]/omega)), where gamma is the maximum
    instantaneous population growth rate (normally referred to as r) and
    omega is the equilibrium abundance (normally referred to as K).  "gompertz"
    is a modified version of the Gompertz-logistic model, N[i,t] =
    N[i,t-1]*exp(gamma*(1-log(N[i,t-1]+1)/log(omega+1))), where the
    interpretations of gamma and omega are similar to in the Ricker model</p></dd>

  <dt id="arg-fix">fix<a class="anchor" aria-label="anchor" href="#arg-fix"></a></dt>
<dd><p>If "omega", omega is fixed at 1. If "gamma", gamma is fixed at 0</p></dd>

  <dt id="arg-immigration">immigration<a class="anchor" aria-label="anchor" href="#arg-immigration"></a></dt>
<dd><p>Logical specifying whether or not to include an immigration
    term (iota) in population dynamics</p></dd>

  <dt id="arg-iotaformula">iotaformula<a class="anchor" aria-label="anchor" href="#arg-iotaformula"></a></dt>
<dd><p>Right-hand sided formula for average number of immigrants
    to a site per time step</p></dd>

  <dt id="arg-starts">starts<a class="anchor" aria-label="anchor" href="#arg-starts"></a></dt>
<dd><p>Vector of starting values</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Optimization method used by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code></p></dd>

  <dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>Logical specifying whether or not to compute standard errors</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to optim, such as lower and upper bounds</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>


<p>These models generalize multinomial N-mixture models (Royle et al. 2004) by
relaxing the closure assumption (Dail and Madsen 2011, Hostetler and Chandler
2015, Sollmann et al. 2015).</p>
<p>The models include two or three additional parameters:
gamma, either the recruitment rate (births and immigrations), the
finite rate of increase, or the maximum instantaneous rate of increase;
omega, either the apparent survival rate (deaths and emigrations) or the
equilibrium abundance (carrying capacity); and iota, the number of immigrants
per site and year. Estimates of
population size at each time period can be derived from these
parameters, and thus so can trend estimates. Or, trend can be estimated
directly using dynamics="trend".</p>
<p>When immigration is set to FALSE (the default), iota is not modeled.
When immigration is set to TRUE and dynamics is set to "autoreg", the model
will separately estimate birth rate (gamma) and number of immigrants (iota).
When immigration is set to TRUE and dynamics is set to "trend", "ricker", or
"gompertz", the model will separately estimate local contributions to
population growth (gamma and omega) and number of immigrants (iota).</p>
<p>The latent abundance distribution, \(f(N | \mathbf{\theta})\) can be set as a Poisson, negative binomial, or zero-inflated
Poisson random
variable, depending on the setting of the <code>mixture</code> argument,
<code>mixture = "P"</code>, <code>mixture = "NB"</code>, <code>mixture = "ZIP"</code>
respectively.  For the first two distributions, the mean of \(N_i\) is
\(\lambda_i\).  If \(N_i \sim NB\), then an
additional parameter, \(\alpha\), describes dispersion (lower
\(\alpha\) implies higher variance). For the ZIP distribution,
the mean is \(\lambda_i(1-\psi)\), where psi is the
zero-inflation parameter.</p>
<p>For "constant", "autoreg", or "notrend" dynamics, the latent abundance state
following the initial sampling period arises
from a
Markovian process in which survivors are modeled as \(S_{it} \sim
Binomial(N_{it-1}, \omega_{it})\), and recruits
follow \(G_{it} \sim Poisson(\gamma_{it})\).
Alternative population dynamics can be specified
using the <code>dynamics</code> and <code>immigration</code> arguments.</p>
<p>\(\lambda_i\), \(\gamma_{it}\), and
\(\iota_{it}\) are modeled
using the the log link.
\(p_{ijt}\) is modeled using
the logit link.
\(\omega_{it}\) is either modeled using the logit link (for
"constant", "autoreg", or "notrend" dynamics) or the log link (for "ricker"
or "gompertz" dynamics).  For "trend" dynamics, \(\omega_{it}\)
is not modeled.</p>
<p>The detection process is modeled as multinomial:
\(\mathbf{y_{it}} \sim
Multinomial(N_{it}, \pi_{it})\),
where \(\pi_{ijt}\) is the multinomial cell probability for
plot i at time t on occasion j.</p>
<p>Options for the detection process include equal-interval removal sampling
(<code>"removal"</code>), double observer sampling (<code>"double"</code>), or
dependent double-observer sampling (<code>"depDouble"</code>). This option is
specified when setting up the data using <code><a href="unmarkedFrameMMO.html">unmarkedFrameMMO</a></code>. Note
that unlike the related functions <code><a href="multinomPois.html">multinomPois</a></code> and
<code><a href="gmultmix.html">gmultmix</a></code>, custom functions for the detection process (i.e.,
<code>piFun</code>s) are not supported. To request additional options contact the author.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class unmarkedFitMMO</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Dail, D. and L. Madsen (2011) Models for Estimating Abundance from
  Repeated Counts of an Open Metapopulation. <em>Biometrics</em>. 67: 577-587.</p>
<p>Hostetler, J. A. and R. B. Chandler (2015) Improved State-space Models for
  Inference about Spatial and Temporal Variation in Abundance from Count Data.
  <em>Ecology</em> 96: 1713-1723.</p>
<p>Royle, J. A. (2004). Generalized estimators of avian abundance from
  count survey data. <em>Animal Biodiversity and Conservation</em> 27(1), 375-386.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ken Kellner <a href="mailto:contact@kenkellner.com">contact@kenkellner.com</a>, Richard Chandler</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>When gamma or omega are modeled using year-specific covariates, the
  covariate data for the final year will be ignored; however,
  they must be supplied.</p>
<p>If the time gap between primary periods is not constant, an M by T
  matrix of integers should be supplied to <code><a href="unmarkedFrameMMO.html">unmarkedFrameMMO</a></code>
  using the <code>primaryPeriod</code> argument.</p>
<p>Secondary sampling periods are optional, but can greatly improve the
  precision of the estimates.</p>
    </div>
    <div id="warning">
    <h2>Warning</h2>
    <p>This function can be extremely slow, especially if
  there are covariates of gamma or omega. Consider testing the timing on
  a small subset of the data, perhaps with se=FALSE. Finding the lowest
  value of K that does not affect estimates will also help with speed.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="multinomPois.html">multinomPois</a>, <a href="gmultmix.html">gmultmix</a>, <a href="unmarkedFrameMMO.html">unmarkedFrameMMO</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>   </span></span>
<span class="r-in"><span>  <span class="co">#Generate some data </span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">lambda</span><span class="op">=</span><span class="fl">4</span>; <span class="va">gamma</span><span class="op">=</span><span class="fl">0.5</span>; <span class="va">omega</span><span class="op">=</span><span class="fl">0.8</span>; <span class="va">p</span><span class="op">=</span><span class="fl">0.5</span></span></span>
<span class="r-in"><span>  <span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">100</span>; <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">M</span>, <span class="fl">3</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">M</span>, <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">S</span> <span class="op">&lt;-</span> <span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">M</span>, <span class="cn">T</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">N</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">N</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">p</span><span class="op">)</span>    <span class="co"># Observe some</span></span></span>
<span class="r-in"><span>    <span class="va">Nleft1</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>         <span class="co"># Remove them</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Nleft1</span>, <span class="va">p</span><span class="op">)</span>   <span class="co"># ...</span></span></span>
<span class="r-in"><span>    <span class="va">Nleft2</span> <span class="op">&lt;-</span> <span class="va">Nleft1</span> <span class="op">-</span> <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Nleft2</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">S</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">N</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span>, <span class="va">omega</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">G</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">gamma</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">N</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">S</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="va">G</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span></span></span>
<span class="r-in"><span>      <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">N</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>, <span class="va">p</span><span class="op">)</span>    <span class="co"># Observe some</span></span></span>
<span class="r-in"><span>      <span class="va">Nleft1</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>         <span class="co"># Remove them</span></span></span>
<span class="r-in"><span>      <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Nleft1</span>, <span class="va">p</span><span class="op">)</span>   <span class="co"># ...</span></span></span>
<span class="r-in"><span>      <span class="va">Nleft2</span> <span class="op">&lt;-</span> <span class="va">Nleft1</span> <span class="op">-</span> <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>      <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span>,<span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Nleft2</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">M</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#Create some random covariate data</span></span></span>
<span class="r-in"><span>  <span class="va">sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="co">#Create unmarked frame</span></span></span>
<span class="r-in"><span>  <span class="va">umf</span> <span class="op">&lt;-</span> <span class="fu"><a href="unmarkedFrameMMO.html">unmarkedFrameMMO</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span>, numPrimary<span class="op">=</span><span class="fl">5</span>, siteCovs<span class="op">=</span><span class="va">sc</span>, type<span class="op">=</span><span class="st">"removal"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Fit model</span></span></span>
<span class="r-in"><span>  <span class="op">(</span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">multmixOpen</span><span class="op">(</span><span class="op">~</span><span class="va">x1</span>, <span class="op">~</span><span class="fl">1</span>, <span class="op">~</span><span class="fl">1</span>, <span class="op">~</span><span class="fl">1</span>, K<span class="op">=</span><span class="fl">30</span>, data<span class="op">=</span><span class="va">umf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#Compare to truth</span></span></span>
<span class="r-in"><span>  <span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>model<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">cf</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="va">cf</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">cf</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">cf</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">cf</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             truth<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="fl">0</span>, <span class="va">gamma</span>, <span class="va">omega</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Predict</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="predict-methods.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, type<span class="op">=</span><span class="st">'lambda'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Check fit with parametric bootstrap</span></span></span>
<span class="r-in"><span>  <span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="parboot.html">parboot</a></span><span class="op">(</span><span class="va">fit</span>, nsims<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Empirical Bayes estimates of abundance for each site / year</span></span></span>
<span class="r-in"><span>  <span class="va">re</span> <span class="op">&lt;-</span> <span class="fu"><a href="ranef-methods.html">ranef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">re</span>, layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">5</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://chandlerlab.uga.edu/richard-chandler-phd/" class="external-link">Richard Chandler</a>, <a href="https://kenkellner.com" class="external-link">Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith, Lea Pautrel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

