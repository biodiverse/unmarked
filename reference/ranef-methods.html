<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Methods for Function ranef in Package unmarked — ranef-methods • unmarked</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Methods for Function ranef in Package unmarked — ranef-methods"><meta property="og:description" content="Estimate posterior distributions of the random variables (latent
abundance or occurrence) using empirical Bayes methods. These methods
return an object storing the posterior distributions of the latent
variables at each site, and for each year (primary period) in the case
of open population models. See unmarkedRanef-class for methods
used to manipulate the returned object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unmarked</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/unmarked.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cap-recap.html">Modeling variation in abundance using capture-recapture data</a>
    </li>
    <li>
      <a href="../articles/colext.html">Dynamic occupancy models in unmarked</a>
    </li>
    <li>
      <a href="../articles/contributing_to_unmarked.html">Contributing to unmarked: guide to adding a new model to `unmarked`</a>
    </li>
    <li>
      <a href="../articles/distsamp.html">Distance sampling analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/occuMulti.html">Multispecies occupancy models with occuMulti</a>
    </li>
    <li>
      <a href="../articles/powerAnalysis.html">Power Analysis in unmarked</a>
    </li>
    <li>
      <a href="../articles/simulate.html">Simulating datasets</a>
    </li>
    <li>
      <a href="../articles/spp-dist.html">Modeling and mapping species distributions</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/hmecology/unmarked/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Methods for Function <code>ranef</code> in Package <span class="pkg">unmarked</span></h1>

    <div class="hidden name"><code>ranef-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate posterior distributions of the random variables (latent
abundance or occurrence) using empirical Bayes methods. These methods
return an object storing the posterior distributions of the latent
variables at each site, and for each year (primary period) in the case
of open population models. See <a href="unmarkedRanef-class.html">unmarkedRanef-class</a> for methods
used to manipulate the returned object.</p>
    </div>


    <div id="methods">
    <h2>Methods</h2>

<dl><dt><code>signature(object = "unmarkedFitOccu")</code></dt>
<dd><p>Computes the
  conditional distribution of occurrence given the data and the
  estimates of the
  fixed effects, \(Pr(z_i=1 | y_{ij}, \hat{\psi}_i,
  \hat{p}_{ij})\)</p></dd>

<dt><code>signature(object = "unmarkedFitOccuRN")</code></dt>
<dd><p>Computes the
  conditional abundance distribution given the data and the estimates of
  the fixed effects, \(Pr(N_i=k | y_{ij}, \hat{\psi}_i, \hat{r}_{ij})
  k = 0,1,\dots,K\)</p></dd>

<dt><code>signature(object = "unmarkedFitPCount")</code></dt>
<dd><p>\(Pr(N_i=k |
  y_{ij}, \hat{\lambda}_i, \hat{p}_{ij}) k = 0,1,\dots,K\)</p></dd>

<dt><code>signature(object = "unmarkedFitMPois")</code></dt>
<dd><p>\(Pr(N_i=k |
  y_{ij}, \hat{\lambda}_i, \hat{p}_{ij}) k = 0,1,\dots,K\)</p></dd>

<dt><code>signature(object = "unmarkedFitDS")</code></dt>
<dd><p>\(Pr(N_i=k |
  y_{i,1:J}, \hat{\lambda}_i, \hat{\sigma}_{i}) k =
  0,1,\dots,K\)</p></dd>

<dt><code>signature(object = "unmarkedFitGMM")</code></dt>
<dd><p>\(Pr(M_i=k |
  y_{i,1:J,t}, \hat{\lambda}_i, \hat{\phi}_{it}, \hat{p}_{ijt})  k =
  0,1,\dots,K\)</p></dd>

<dt><code>signature(object = "unmarkedFitGDS")</code></dt>
<dd><p>\(Pr(M_i=k |
  y_{i,1:J,t}, \hat{\lambda}_i, \hat{\phi}_{it}, \hat{\sigma}_{it})
  k = 0,1,\dots,K\)</p></dd>

<dt><code>signature(object = "unmarkedFitColExt")</code></dt>
<dd><p>\(Pr(z_{it}=1 |
  y_{ijt}, \hat{\psi}_i, \hat{\gamma}_{it}, \hat{\epsilon}_{it},
  \hat{p}_{ijt})\)</p></dd>

<dt><code>signature(object = "unmarkedFitPCO")</code></dt>
<dd><p>\(Pr(N_{it}=k |
  y_{ijt}, \hat{\lambda}_i, \hat{\gamma}_{it}, \hat{\omega}_{it},
  \hat{\iota}_{it}, \hat{p}_{ijt}) k = 0,1,...,K\)</p></dd>



</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>From Carlin and Louis (1996): “... the Bayesian approach to
  inference depends on a prior distribution for the model
  parameters. This prior can depend on unknown parameters which in turn
  may follow some second-stage prior. This sequence of parameters and
  priors consitutes a hierarchical model. The hierarchy must stop at
  some point, with all remaining prior parameters assumed known. Rather
  than make this assumption, the basic empirical Bayes approach uses the
  observed data to estimate these final stage parameters (or to estimate
  the Bayes rule), and proceeds as in a standard Bayesian analysis.”</p>
    </div>
    <div id="warning">
    <h2>Warning</h2>
    <p>Empirical Bayes methods can underestimate the variance of the
  posterior distribution because they do not account for uncertainty in
  the hyperparameters (lambda or psi). Eventually, we hope to add
  methods to account for the uncertainty of the hyperparameters.</p>
<p>Note also that the posterior mode appears to exhibit some bias as an
  estimator or abundance. Consider using the posterior mean instead,
  even though it will not be an integer in general. More
  simulation studies are needed to evaluate the performance of empirical
  Bayes methods for these models.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Richard Chandler <a href="mailto:rbchan@uga.edu">rbchan@uga.edu</a></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Laird, N.M. and T.A. Louis. 1987. Empirical Bayes confidence intervals
  based on bootstrap samples. Journal of the American Statistical
  Association 82:739–750.</p>
<p>Carlin, B.P and T.A Louis. 1996. Bayes and Empirical Bayes Methods for
  Data Analysis. Chapman and Hall/CRC.</p>
<p>Royle, J.A and R.M. Dorazio. 2008. Hierarchical Modeling and Inference
  in Ecology. Academic Press.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="unmarkedRanef-class.html">unmarkedRanef-class</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate data under N-mixture model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4564</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">R</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">R</span>, <span class="va">J</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">R</span><span class="op">*</span><span class="va">J</span>, <span class="va">N</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model</span></span></span>
<span class="r-in"><span><span class="va">umf</span> <span class="op">&lt;-</span> <span class="fu"><a href="unmarkedFramePCount.html">unmarkedFramePCount</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm</span> <span class="op">&lt;-</span> <span class="fu"><a href="pcount.html">pcount</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span> <span class="op">~</span><span class="fl">1</span>, <span class="va">umf</span>, K<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimates of conditional abundance distribution at each site</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">re</span> <span class="op">&lt;-</span> <span class="fu">ranef</span><span class="op">(</span><span class="va">fm</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Mean Mode 2.5% 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  5.456813    5    4     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 12.263316   12   10    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 11.974866   12   10    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 12.512518   12   10    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  7.515203    7    6    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  6.910344    7    5     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 11.772003   12   10    14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 11.590102   11    9    14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 11.957508   12   10    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  5.239116    5    4     7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 12.811799   13   10    16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  6.871755    7    5     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 8 rows ]</span>
<span class="r-in"><span><span class="co"># Best Unbiased Predictors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="unmarkedRanef-class.html">bup</a></span><span class="op">(</span><span class="va">re</span>, stat<span class="op">=</span><span class="st">"mean"</span><span class="op">)</span>           <span class="co"># Posterior mean</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  5.456813 12.263316 11.974866 12.512518  7.515203  6.910344 11.772003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 11.590102 11.957508  5.239116 12.811799  6.871755  9.393458 13.201976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15]  4.531943  7.803122  7.961635  6.365969 11.728030 13.016582</span>
<span class="r-in"><span><span class="fu"><a href="unmarkedRanef-class.html">bup</a></span><span class="op">(</span><span class="va">re</span>, stat<span class="op">=</span><span class="st">"mode"</span><span class="op">)</span>           <span class="co"># Posterior mode</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  5 12 12 12  7  7 12 11 12  5 13  7  9 13  4  8  8  6 12 13</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">re</span>, level<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span> <span class="co"># 90% CI</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5% 95%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  4   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 10  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 10  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 10  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  6   9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  5   9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 10  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 10  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 10  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  4   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 11  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  5   9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  8  11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 11  16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  3   6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  6  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]  6  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  5   8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 10  14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 11  15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">re</span>, subset<span class="op">=</span><span class="va">site</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ranef-methods-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare estimates to truth</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 195</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="unmarkedRanef-class.html">bup</a></span><span class="op">(</span><span class="va">re</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 190.8781</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract all values in convenient formats</span></span></span>
<span class="r-in"><span><span class="va">post.df</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">re</span>, <span class="st">"data.frame"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">post.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     site N         p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1 0 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     1 1 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41     1 2 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61     1 3 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81     1 4 0.1624616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101    1 5 0.3956360</span>
<span class="r-in"><span><span class="va">post.arr</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">re</span>, <span class="st">"array"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Generate posterior predictive distribution for a function</span></span></span>
<span class="r-in"><span><span class="co">#of random variables using predict()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#First, create a function that operates on a vector of </span></span></span>
<span class="r-in"><span><span class="co">#length M (if you fit a single-season model) or a matrix of </span></span></span>
<span class="r-in"><span><span class="co">#dimensions MxT (if a dynamic model), where</span></span></span>
<span class="r-in"><span><span class="co">#M = nsites and T = n primary periods</span></span></span>
<span class="r-in"><span><span class="co">#Our function will generate mean abundance for sites 1-10 and sites 11-20</span></span></span>
<span class="r-in"><span><span class="va">myfunc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="co">#x will be length 20 since M=20</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#Mean of first 10 sites</span></span></span>
<span class="r-in"><span>  <span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">#Mean of sites 11-20</span></span></span>
<span class="r-in"><span>  <span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#Naming elements of the output is optional but helpful</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>group1<span class="op">=</span><span class="va">group1</span>, group2<span class="op">=</span><span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Get 100 samples of the values calculated in your function</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict-methods.html">predict</a></span><span class="op">(</span><span class="va">re</span>, func<span class="op">=</span><span class="va">myfunc</span>, nsims<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60] [,61]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,62] [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72] [,73]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,74] [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,86] [,87] [,88] [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,98] [,99] [,100]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 2 rows ]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Summarize posterior</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">pr</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           se<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pr</span>, <span class="fl">1</span>, <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           lower<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pr</span>, <span class="fl">1</span>, <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span>, <span class="fl">0.025</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">pr</span>, <span class="fl">1</span>, <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mean        se  lower   upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group1 9.687 0.3794347 8.8475 10.3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group2 9.375 0.3828060 8.6000 10.1525</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Alternatively, you can return the posterior predictive distribution</span></span></span>
<span class="r-in"><span><span class="co">#and run operations on it separately</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ppd</span> <span class="op">&lt;-</span> <span class="fu"><a href="posteriorSamples.html">posteriorSamples</a></span><span class="op">(</span><span class="va">re</span>, nsims<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ reached getOption("max.print") -- omitted 10 row(s) and 97 matrix slice(s) ]</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://chandlerlab.uga.edu/richard-chandler-phd/" class="external-link">Richard Chandler</a>, <a href="https://kenkellner.com" class="external-link">Ken Kellner</a>, Ian Fiske, David Miller, Andy Royle, Jeff Hostetler, Rebecca Hutchinson, Adam Smith, Lea Pautrel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

